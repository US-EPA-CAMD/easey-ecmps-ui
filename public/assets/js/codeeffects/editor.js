
/* Code Effects Software Â© 2020 | https://CodeEffects.com | 5.0.21.2 | August 03, 2020 */

window || (this.window = this); window.CodeEffects || (window.CodeEffects = { typeName: "CodeEffects", getName: function () { return "CodeEffects" }, __namespace: !0 }); CodeEffects.register || (CodeEffects.register = function (l) { var p = window; l = l.split("."); for (var d = 0; d < l.length; d++){ var n = l[d], m = p[n]; m || (m = p[n] = { typeName: l.slice(0, d + 1).join("."), __namespace: !0 }, m.getName = function () { return this.typeName }); p = m } }); CodeEffects.register("CodeEffects.Rule.Client"); CodeEffects.register("CodeEffects.Rule.Models"); CodeEffects.register("CodeEffects.Rule.Menu");
CodeEffects.register("CodeEffects.Rule.Calendar");CodeEffects.register("CodeEffects.Rule.Time");CodeEffects.register("CodeEffects.Rule.TextBox");CodeEffects.register("CodeEffects.Rule.Common");var $rule=CodeEffects.Rule;$rule.Models.RuleModel=function(){};$rule.Models.OperatorType={String:0,Numeric:1,Date:2,Time:3,Bool:4,Enum:6,Collection:8,None:16};$rule.Common.ValueInputType={Fields:0,User:2,All:4};$rule.Client.Element=function(){};$rule.Client.FunctionType={Name:0,Param:1,Comma:2,End:3,None:4};
$rule.Client.InputType={Field:0,Input:1,None:2};$rule.Client.CalculationType={Field:0,LeftParenthesis:1,RightParenthesis:2,Multiplication:3,Division:4,Addition:6,Subtraction:7,Number:8,None:9,Function:10};$rule.Client.CollectionType={Value:0,Reference:2,Generic:4,None:8};$rule.Client.SelectionType={Exists:0,DoesNotExist:1,None:2};
$rule.Client.ElementType={Flow:0,Field:1,Function:2,Operator:3,Value:4,Clause:6,Action:7,LeftParenthesis:8,RightParenthesis:9,LeftBracket:10,RightBracket:11,Calculation:12,Tab:13,NewLine:15,HtmlTag:16,Setter:17,LeftSource:18,RightSource:19,Where:20,Exists:22};$rule.Client.type={IE:0,Chrome:1,Firefox:2,Opera:3,Other:4};$rule.Client.browser=null;$rule.Client.version=Object.hasOwnProperty.call(window,"ActiveXObject")&&!window.ActiveXObject?11:0;
11==$rule.Client.version||navigator.appName&&-1<navigator.appName.toLowerCase().indexOf("explorer")||-1<navigator.userAgent.indexOf(" MSIE ")?($rule.Client.browser=$rule.Client.type.IE,11!=$rule.Client.version&&($rule.Client.version=parseFloat(navigator.userAgent.match(/MSIE (\d+\.\d+)/)[1]))):-1<navigator.userAgent.toLowerCase().indexOf(" firefox/")?$rule.Client.browser=$rule.Client.type.Firefox:-1<navigator.userAgent.toLowerCase().indexOf(" applewebkit/")?$rule.Client.browser=$rule.Client.type.Chrome:
navigator.appName&&-1<navigator.appName.toLowerCase().indexOf("opera")||-1<navigator.userAgent.toLowerCase().indexOf("opera/")?$rule.Client.browser=$rule.Client.type.Opera:$rule.Client.browser=$rule.Client.type.Other;if($rule.Client.browser==$rule.Client.type.IE&&9>$rule.Client.version)throw Error("Your browser is not supported by Code Effects rules engine (CE482)");$rule.defined=function(l){return null!=l&&"undefined"!=typeof l&&"NaN"!=String(l)};
$rule.isNumeric=function(l){return!isNaN(parseFloat(l))&&isFinite(l)};$rule.isInteger=function(l){return $rule.isNumeric(l)&&0===l%1};$rule.text=function(l,p){if(!l.tagName)return null;if($rule.defined(p))$rule.defined(document.getElementsByTagName("BODY")[0].innerText)?l.innerText=p.toString():l.textContent=p.toString();else return $rule.defined(document.getElementsByTagName("BODY")[0].innerText)?l.innerText:l.textContent};
$rule.trim=function(l){return $rule.defined(l)&&0!==l.length?l.replace(/^\s+|\s+$/g,""):l};$rule.encode=function(l){return!$rule.defined(l)||1>l.length?l:String(l).replace(/&/g,"&amp;").replace(/ /g,"&nbsp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\/g,"&#92;").replace(/'/g,"&#39;")};
$rule.decode=function(l,p){if(!$rule.defined(l)||4>l.length)return l;var d=l;p||(d=String(d).replace(/&#92;/g,"\\").replace(/&quot;/g,'"'));return String(d).replace(/&#39;/g,"'").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&nbsp;/g," ").replace(/&amp;/g,"&")};$rule.highlight=function(l){l.style.backgroundColor="#ffff91"};$rule.dim=function(l){l.style.backgroundColor=""};
$rule.getElementWidth=function(l){return l.offsetWidth&&0<l.offsetWidth?l.offsetWidth:l.style.pixelWidth&&0<l.style.pixelWidth?l.style.pixelWidth:l.style.posWidth&&0<l.style.posWidth?l.style.posWidth:l.style.width&&0<l.style.width.length?parseInt(l.style.width.substr(0,l.style.width.length-2)):0};
$rule.getElementHeight=function(l){return $rule.defined(l.offsetHeight)&&0<l.offsetHeight?l.offsetHeight:$rule.defined(l.style.pixelHeight)&&0<l.style.pixelHeight?l.style.pixelHeight:$rule.defined(l.style.posHeight)&&0<l.style.posHeight?l.style.posHeight:$rule.defined(l.style.height)&&0<l.style.height.length?parseInt(l.style.height.substr(0,l.style.height.length-2),10):50};
$rule.getWindowDimensions=function(){var l=0,p=0;self.innerHeight?(l=window.innerHeight,p=window.innerWidth):document.documentElement&&document.documentElement.clientHeight?(l=document.documentElement.clientHeight,p=document.documentElement.clientWidth):document.body&&(l=document.body.clientHeight,p=document.body.clientWidth);return{height:parseInt(l,10),width:parseInt(p,10)}};
$rule.getScrollWidth=function(){var l=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft;return l?l:0};$rule.getScrollHeight=function(){var l=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;return l?l:0};
$rule.position=function(l,p){var d=$rule.getBounds(l),n=$rule.getBounds(p),m=$rule.getWindowDimensions(),u=$rule.getScrollHeight(),r=$rule.getScrollWidth();p.style.top=m.height>d.y-u+d.height+n.height?d.y+d.height+"px":m.height-n.height+u-4+"px";p.style.left=m.width>d.x-r+d.width+n.width?d.x+d.width+6+"px":m.width-n.width+r-4+"px"};
$rule.leftAlign=function(l,p){var d=$rule.getBounds(l),n=$rule.getBounds(p),m=$rule.getWindowDimensions(),u=$rule.getScrollWidth();p.style.left=m.width>d.x-u+d.width+n.width?d.x+"px":m.width-n.width+u-4+"px"};$rule.getType=function(l){if(!$rule.defined(l.constructor))throw Error("CL1");l=String(l.constructor).match(/function\s+(\w+)/);return $rule.defined(l)?l[1]:"undefined"};$rule.getDocument=function(l){l=l.ownerDocument||l.document||l;return l.defaultView||l.parentWindow};
$rule.getStyle=function(l){if(3===l.nodeType)return null;var p=$rule.getDocument(l);l.documentElement&&(l=l.documentElement);var d=p&&l!==p&&p.getComputedStyle?p.getComputedStyle(l,null):l.currentStyle||l.style;if(!d&&$rule.Client.browser==$rule.Client.type.Chrome&&l.style){d=l.style.display;var n=l.style.position;l.style.position="absolute";l.style.display="block";p=p.getComputedStyle(l,null);l.style.display=d;l.style.position=n;d={};if(p)for(l=0;l<p.length;l++)d[l]=p[l];d.display="none"}return d};
$rule.getParentById=function(l,p){return $rule.defined(l)?l.id&&l.id==p?l:l.parentNode?$rule.getParentById(l.parentNode,p):null:null};$rule.getParentByTagName=function(l,p,d){$rule.defined(d)||(d=0);return 0<d&&l.tagName&&l.tagName==p?l:l.parentNode?$rule.getParentByTagName(l.parentNode,p,++d):null};
$rule.getChildrenByTagName=function(l,p,d){var n=[];if(l.childNodes)for(var m=0;m<l.childNodes.length;m++){var u=l.childNodes[m];u.tagName&&u.tagName==p&&n.push(u);if(d&&u.childNodes&&0<u.childNodes.length){u=$rule.getChildrenByTagName(u,p,d);for(var r=0;r<u.length;r++)n.push(u[r])}}return n};
$rule.getChildrenByAttribute=function(l,p,d){var n=[];if(l.childNodes)for(var m=0;m<l.childNodes.length;m++){var u=l.childNodes[m];if(u.tagName&&u.getAttribute){var r=u.getAttribute(p);!r||$rule.defined(d)&&r!=d||n.push(u)}if(u.childNodes&&0<u.childNodes.length)for(u=$rule.getChildrenByAttribute(u,p,d),r=0;r<u.length;r++)n.push(u[r])}return n};
$rule.StringBuilder=function(){var l=[];this.append=function(p){p=$rule.defined(p)?$rule.getType(p)!=$rule.getType(new String)?String(p):p:"";0<p.length&&(l[l.length]=p)};this.dump=function(){return l.join("")}};$rule.Point=function(l,p){this.x=l;this.y=p};
switch($rule.Client.browser){case $rule.Client.type.Chrome:$rule.getPosition=function(l){if(l.window&&l.window===l||9===l.nodeType)return new $rule.Point(0,0);for(var p=0,d=0,n=null,m,u=l;u;n=m,u=u.offsetParent){m=$rule.getStyle(u);var r=u.tagName?u.tagName.toUpperCase():null;!u.offsetLeft&&!u.offsetTop||"BODY"===r&&n&&"absolute"===n.position||(p+=u.offsetLeft,d+=u.offsetTop)}m=(m=$rule.getStyle(l))?m.position:null;if(!m||"absolute"!==m)for(l=l.parentNode;l&&(r=l.tagName?l.tagName.toUpperCase():null,
"BODY"!==r&&"HTML"!==r&&(l.scrollLeft||l.scrollTop)&&(p-=l.scrollLeft||0,d-=l.scrollTop||0),!(m=(m=$rule.getStyle(l))?m.position:null)||"absolute"!==m);l=l.parentNode);return new $rule.Point(p,d)};break;case $rule.Client.type.Opera:$rule.getPosition=function(l){if(l.window&&l.window===l||9===l.nodeType)return new $rule.Point(0,0);for(var p=0,d=0,n=l;n;n=n.offsetParent)p+=n.offsetLeft||0,d+=n.offsetTop||0;n=(n=l.style.position)&&"static"!==n;for(l=l.parentNode;l;l=l.parentNode){var m=l.tagName?l.tagName.toUpperCase():
null;"BODY"===m||"HTML"===m||!l.scrollLeft&&!l.scrollTop||!n||"scroll"!==l.style.overflow&&"auto"!==l.style.overflow||(p-=l.scrollLeft||0,d-=l.scrollTop||0);m=l&&l.style?l.style.position:null;n=n||m&&"static"!==m}return new $rule.Point(p,d)};break;case $rule.Client.type.Firefox:$rule.getPosition=function(l){if(l.window&&l.window===l||9===l.nodeType)return new $rule.Point(0,0);for(var p=0,d=0,n=null,m=null,u,r=l;r;n=r,m=u,r=r.offsetParent){var Q=r.tagName?r.tagName.toUpperCase():null;u=$rule.getStyle(r);
(r.offsetLeft||r.offsetTop)&&("BODY"!==Q||m&&"absolute"===m.position)&&(p+=r.offsetLeft,d+=r.offsetTop);null!==n&&u&&("TABLE"!==Q&&"TD"!==Q&&"HTML"!==Q&&(p+=parseInt(u.borderLeftWidth)||0,d+=parseInt(u.borderTopWidth)||0),"TABLE"!==Q||"relative"!==u.position&&"absolute"!==u.position||(p+=parseInt(u.marginLeft)||0,d+=parseInt(u.marginTop)||0))}u=(u=$rule.getStyle(l))?u.position:null;if(!u||"absolute"!==u)for(l=l.parentNode;l;l=l.parentNode)if(Q=l.tagName?l.tagName.toUpperCase():null,"BODY"!==Q&&"HTML"!==
Q&&(l.scrollLeft||l.scrollTop)&&(p-=l.scrollLeft||0,d-=l.scrollTop||0,u=$rule.getStyle(l)))p+=parseInt(u.borderLeftWidth)||0,d+=parseInt(u.borderTopWidth)||0;return new $rule.Point(p,d)};break;default:$rule.getPosition=function(l){if(l.self||9===l.nodeType)return new $rule.Point(0,0);var p={bottom:0,height:0,left:0,right:0,top:0,width:0};try{p=l.getBoundingClientRect()}catch(r){}if(!p)return new $rule.Point(0,0);var d=l.ownerDocument.documentElement,n=p.left-2+d.scrollLeft;p=p.top-2+d.scrollTop;try{var m=
l.ownerDocument.parentWindow.frameElement||null;if(m){var u="0"===m.frameBorder||"no"===m.frameBorder?2:0;n+=u;p+=u}}catch(r){}return new $rule.Point(n,p)}}$rule.getBounds=function(l){var p=$rule.getPosition(l);return{x:p.x,y:p.y,width:$rule.getElementWidth(l),height:$rule.getElementHeight(l)}};
$rule.topZindex=function(l,p){p=p||1;if(l.childNodes)for(var d=0,n,m=l.childNodes.length;d<m;d++)n=l.childNodes[d],n.tagName&&n.style&&$rule.isInteger(n.style.zIndex)&&n.style.zIndex>p&&(p=n.style.zIndex+1),0<n.childNodes.length&&(p=$rule.topZindex(n,p));return p};
$rule.Json=function(){this.serialize=function(p){var d=new $rule.StringBuilder;l(p,d,!1);return d.dump()};this.deserialize=function(p){if(!$rule.defined(p)||0==p.length)throw Error("CL2");try{return eval("("+p.replace(/\\"/g,'"')+")")}catch(d){throw Error("CL41");}};var l=function(p,d){var n;switch(typeof p){case "number":isFinite(p)?d.append(p.toString()):d.append("null");break;case "string":d.append('"');d.append(p);d.append('"');break;case "boolean":d.append(p.toString());break;case "object":if($rule.defined(p))if($rule.getType(p)==
$rule.getType([])){d.append("[");for(n=0;n<p.length;++n)0<n&&d.append(","),l(p[n],d);d.append("]")}else{var m=[],u=0;for(n in p)m[u++]=n;d.append("{");var r=!1;for(n=0;n<u;n++){var Q=p[m[n]];$rule.defined(Q)&&"function"!==typeof Q&&(r?d.append(","):r=!0,l(m[n],d),d.append(":"),l(Q,d))}d.append("}")}else d.append("null");break;default:d.append("null")}}};
$rule.formatDate=function(l,p){function d(q){return 10>q?"0"+q:q.toString()}function n(q,w){for(var c=0,F=!1,W=0,P=q.length;W<P;W++){var aa=q.charAt(W);switch(aa){case "'":F?w.append("'"):c++;F=!1;break;case "\\":F&&w.append("\\");F=!F;break;default:w.append(aa),F=!1}}return c}function m(q){return 10>q?"00"+q:100>q?"0"+q:q.toString()}if(!p||0===p.length||"i"===p)return l.toString();p=function(q){$rule.defined(q)||(q="d");if(1==q.length)switch(q){case "F":return"dddd, MMMM dd, yyyy h:mm:ss tt";case "s":return"yyyy'-'MM'-'dd'T'HH':'mm':'ss";
case "Y":case "y":return"MMMM, yyyy";case "M":case "m":return"MMMM dd";case "d":return"M/d/yyyy";case "D":return"dddd, MMMM dd, yyyy";case "t":return"h:mm tt";case "T":return"h:mm:ss tt";default:throw Error("CL61");}return q}(p);for(var u=new $rule.StringBuilder,r,Q=0,H=/dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z/g;;){var N=H.lastIndex;r=H.exec(p);N=p.slice(N,r?r.index:p.length);N=n(N,u);Q+=N;if(!r)break;if(1===Q%2)u.append(r[0]);else switch(r[0]){case "MMMM":u.append($rule.monthNames[l.getMonth()]);
break;case "MMM":u.append($rule.abbrMonthNames[l.getMonth()]);break;case "MM":u.append(d(l.getMonth()+1));break;case "M":u.append(l.getMonth()+1);break;case "dddd":u.append($rule.dayNames[l.getDay()]);break;case "ddd":u.append($rule.abbrDayNames[l.getDay()]);break;case "dd":u.append(d(l.getDate()));break;case "d":u.append(l.getDate());break;case "yyyy":u.append(l.getFullYear());break;case "yy":u.append(d(l.getFullYear()%100));break;case "y":u.append(l.getFullYear()%100);break;case "hh":r=l.getHours()%
12;0===r&&(r=12);u.append(d(r));break;case "h":r=l.getHours()%12;0===r&&(r=12);u.append(r);break;case "HH":u.append(d(l.getHours()));break;case "H":u.append(l.getHours());break;case "mm":u.append(d(l.getMinutes()));break;case "m":u.append(l.getMinutes());break;case "ss":u.append(d(l.getSeconds()));break;case "s":u.append(l.getSeconds());break;case "tt":u.append(12>l.getHours()?"AM":"PM");break;case "t":u.append(12>l.getHours()?"A":"P");break;case "f":u.append(m(l.getMilliseconds()).charAt(0));break;
case "ff":u.append(m(l.getMilliseconds()).substr(0,2));break;case "fff":u.append(m(l.getMilliseconds()));break;case "z":r=l.getTimezoneOffset()/60;u.append((0>=r?"+":"-")+Math.floor(Math.abs(r)));break;case "zz":r=l.getTimezoneOffset()/60;u.append((0>=r?"+":"-")+d(Math.floor(Math.abs(r))));break;case "zzz":r=l.getTimezoneOffset()/60,u.append((0>=r?"+":"-")+d(Math.floor(Math.abs(r)))+":"+d(Math.abs(l.getTimezoneOffset()%60)))}}return u.dump()};
Function.addDelegate=function(l,p){return function(){return p.apply(l,arguments)}};
$rule.Event=function(l){l=l||window.event;var p=this.type=l.type.toLowerCase();this.rawEvent=l;"keypress"==p&&(this.charCode=l.charCode||l.keyCode);l.keyCode?this.keyCode=46==l.keyCode&&"keypress"!=p?127:l.keyCode:l.charCode?this.keyCode=l.charCode:"undefined"!=typeof l.which&&(this.keyCode=l.which);this.offsetY=l.pageY?l.pageY:l.clientY+document.body.scrollTop-document.body.clientTop;this.target=l.target?l.target:l.srcElement;this.ctrlKey=l.ctrlKey;this.metaKey=l.metaKey||!1;this.altKey=l.altKey;
this.shiftKey=l.shiftKey;this.changedTouches=l.changedTouches||null};$rule.Event.prototype={preventDefault:function(){this.rawEvent.preventDefault?this.rawEvent.preventDefault():window.event&&(this.rawEvent.returnValue=!1)},stopPropagation:function(){this.rawEvent.stopPropagation?this.rawEvent.stopPropagation():window.event&&(this.rawEvent.cancelBubble=!0)}};
$rule.addHandler=function(l,p,d){l.ceEvents||(l.ceEvents={});var n=l.ceEvents[p];n||(l.ceEvents[p]=n=[]);if(l.addEventListener){var m=function(u){return d.call(l,new $rule.Event(u))};l.addEventListener(p,m,!1)}else l.attachEvent&&(m=function(){var u={};try{u=$rule.getDocument(l).event}catch(r){}return d.call(l,new $rule.Event(u))},l.attachEvent("on"+p,m));n[n.length]={handler:d,browserHandler:m}};
$rule.addHandlers=function(l,p,d){for(var n in p){var m=p[n];d&&(m=Function.addDelegate(d,m));$rule.addHandler(l,n,m)}};$rule.removeHandlers=function(l){if(l.ceEvents){var p;for(p in l.ceEvents)if(l.ceEvents.hasOwnProperty(p)){var d=l.ceEvents[p];if(d.length&&0<d.length)for(var n=0,m,u=d.length;n<u;n++)m=d[n],m.browserHandler&&(l.removeEventListener?l.removeEventListener(p,m.browserHandler):l.detachEvent&&l.detachEvent(p,m.browserHandler));delete l.ceEvents[p]}delete l.ceEvents}};
$rule.Context={controls:[],addControl:function(l,p){for(var d=0,n=$rule.Context.controls.length;d<n;d++)if($rule.Context.controls[d].id==l)throw Error("Rule Editor with specified ID already exist in the current context (CL85)");$rule.Context.controls.push(new $rule.Context.Item(l,p))},getControl:function(l){for(var p=0,d=$rule.Context.controls.length;p<d;p++)if($rule.Context.controls[p].id==l)return $rule.Context.controls[p].ref;return null},removeControl:function(l){for(var p=[],d=0,n,m=$rule.Context.controls.length;d<
m;d++)n=$rule.Context.controls[d],n.id!=l&&p.push(n);0<p.length&&($rule.Context.controls=p)},clear:function(){$rule.Context.controls=[]}};$rule.Context.Item=function(l,p){this.id=l;this.ref=p};var $ce=$rule.Context.getControl;$rule.Menu.Item=function(){this.Type=this.Name=this.ID=null};
$rule.Menu.Control=function(l,p){var d=$rule,n,m,u,r,Q,H,N=null,q=!1,w=[],c=d.highlight,F=d.dim,W=d.getElementHeight,P=d.defined,aa=d.Client.browser==d.Client.type.Opera;this.init=function(da,R){N=da;Q=R;w=[];aa?d.addHandlers(document,{keydown:y,keypress:S},N):d.addHandlers(document,{keydown:y},N)};this.close=function(){P(n)&&P(n.parentNode)&&n.parentNode.removeChild(n);q=!1;w=[];Q&&Q()};this.select=function(da){if(n)for(var R=$rule.getChildrenByTagName(n,"DIV",!1),pa=0;pa<R.length;pa++)if(0===R[pa].innerHTML.toLowerCase().lastIndexOf(da.toLowerCase(),
0)){ta(R[pa]);break}};this.fill=function(da,R,pa,Ma,kb){if(P(R)&&0!=R.length){q=!0;u=pa;r=kb;H=Ma;ua(da);w=[];m=-1;pa=0;for(var K;pa<R.length;pa++)Ma=R[pa],K=document.createElement("DIV"),K.id="ce104"+da.id+pa,K.innerHTML=Ma.Name,n.appendChild(K),w.push(K),K.setAttribute("ce101",P(Ma.ID)?Ma.ID:""),K.setAttribute("ce102",P(Ma.Type)?Ma.Type:""),K.setAttribute("ce103",pa),K.onclick=function(J){J=J||window.event;J.cancelBubble=!0;u&&u(this.getAttribute("ce101"),this.getAttribute("ce102"),this.innerHTML)},
K.onmouseover=function(J){ta(this);r&&r(this.getAttribute("ce101"))},K.onmouseout=function(J){F(this)};12<R.length&&(R=W(K),P(R)&&0!=R||(R=22),n.style.height=12*R+"px");d.position(da,n);n.onclick=function(J){J=J||window.event;J.cancelBubble=!0;return!1}}else w=[]};this.alignLeft=function(da){P(n)&&P(da)&&d.leftAlign(da,n)};var y=function(da){var R=da.keyCode;if(!q||!P(n)||0==w.length)return!0;switch(R){case 13:-1<m?u&&u(w[m].getAttribute("ce101"),w[m].getAttribute("ce102"),w[m].innerHTML):H&&H();
break;case 32:-1<m&&u&&u(w[m].getAttribute("ce101"),w[m].getAttribute("ce102"),w[m].innerHTML);break;case 38:-1==m&&(m=0);if(0<=m){var pa=w[m].offsetTop-n.scrollTop<w[0].clientHeight;m--;0>m&&(m=0);pa&&(n.scrollTop=w[m].offsetTop);ia(w)}break;case 40:pa=w[0].clientHeight,pa=n.scrollTop+11*pa-m*pa<pa,m++,m>w.length-1&&(m=w.length-1),pa&&(n.scrollTop=w[m-12+1].offsetTop),ia(w)}aa||8!=R&&9!=R&&13!=R&&32!=R&&33!=R&&34!=R&&35!=R&&36!=R&&38!=R&&40!=R||(da.preventDefault&&da.preventDefault(),da.stopPropagation&&
da.stopPropagation())},S=function(da){if(q&&P(n)&&0!=w.length){var R=da.keyCode;8!=R&&9!=R&&13!=R&&32!=R&&33!=R&&34!=R&&35!=R&&36!=R&&38!=R&&40!=R||da.preventDefault();return!1}return!0},ia=function(){Cb();0!=w.length&&(c(w[m]),r&&r(w[m].getAttribute("ce101")))},ta=function(da){m=parseInt(da.getAttribute("ce103"),10);Cb();c(da)},ua=function(da){n=document.createElement("DIV");n.id="ce107"+da.id;n.style.backgroundColor="#fff";P(l)&&(n.className=l);n.style.position="absolute";n.style.padding="2px";
n.style.overflow="auto";n.style.display="inline-block";p&&(n.style.zIndex=$rule.topZindex(document.body));document.body.appendChild(n)},Cb=function(){for(var da=0;da<w.length;da++)F(w[da])}};$rule.Time.Settings=function(l){this.us=-1<l.indexOf("t");this.h=-1<l.indexOf("h")||-1<l.indexOf("H");this.m=-1<l.indexOf("m");this.s=-1<l.indexOf("s");this.dp=this.h||this.m||this.s};
$rule.Time.Picker=function(l,p){var d=$rule,n=null,m,u,r,Q,H,N=!1,q=new Date;var w=q.getHours();var c=q.getMinutes();var F=q.getSeconds();this.defaultFormat=function(){return n?n.defaultFormat():"hh:mm tt"};this.show=function(y,S,ia,ta,ua){Q=y;r=S;H=d.defined(ia)?ia:"hh:mm tt";N=ta;d.defined(ua)&&(w=ua.getHours(),c=ua.getMinutes(),F=ua.getSeconds());W();aa()};this.hide=function(){d.defined(m)&&d.defined(m.parentNode)&&m.parentNode.removeChild(m)};this.position=function(){aa()};this.getId=function(){return d.defined(m)?
m.id:null};var W=function(){m=document.createElement("TABLE");m.id="ce110"+Q.id;m.insertRow(-1).insertCell(-1);d.defined(l)&&(m.className=l);m.cellSpacing=0;m.cellPadding=2;m.style.position="absolute";p&&(m.style.zIndex=$rule.topZindex(document.body));u=document.createElement("TABLE");u.id="ce111"+Q.id;u.setAttribute("ce108","true");u.cellSpacing=0;u.cellPadding=2;var y=u.insertRow(-1).insertCell(-1);y.style.padding="2px 6px";n=new d.Time.Control(y,H,P);n.setValue(w,c,F);m.rows[0].cells[0].appendChild(u);
document.body.appendChild(m);m.onclick=function(S){S=S||window.event;S.cancelBubble=!0;return!1}},P=function(){q=n.getRawValue();w=q.getHours();c=q.getMinutes();F=q.getSeconds();d.defined(r)&&r(n.getValue(),n.getText())},aa=function(){d.defined(Q)&&(d.position(Q,m),N&&d.leftAlign(Q,m))}};
$rule.Time.Control=function(l,p,d){function n(y,S,ia){if(H.defined(y)&&H.defined(y.options)&&0!=y.options.length){for(var ta=!1,ua=0;ua<y.options.length;ua++)if(!ia&&y.options[ua].text==S||ia&&y.options[ua].value==S){y.selectedIndex=ua;ta=!0;break}ta||(y.selectedIndex=0)}}function m(y){return H.defined(y)&&H.defined(y.options)&&-1!=y.selectedIndex?y.options[y.selectedIndex].value:null}function u(y){return H.defined(y)&&H.defined(y.options)&&-1!=y.selectedIndex?y.options[y.selectedIndex].text:null}
function r(y,S,ia){var ta=document.createElement("OPTION");ta.text=S;ta.value=ia;H.Client.browser==H.Client.type.IE?y.options.add(ta):y.appendChild(ta)}function Q(y,S,ia,ta){for(--S;S<ia;S++){var ua=S+1;r(y,ta&&10>ua?"0"+ua:ua,ua)}}var H=$rule;p=H.defined(p)?p:"hh:mm tt";var N=new H.Time.Settings(p),q=function(){if(!N.h)return 0;if(N.us){var y=parseInt(m(F),10);return"AM"==m(aa)?12==y?0:y:12==y?y:y+12}return parseInt(m(F),10)},w=function(y){var S=document.createElement("SELECT");S.id=y;S.style.width=
"44px";l.appendChild(S);Q(S,0,59,!0);return S},c=function(){var y=document.createElement("SPAN");y.innerHTML="<b>:</b>";y.style.marginLeft="2px";y.style.marginRight="2px";l.appendChild(y)},F=null,W=null,P=null,aa=null;N.h&&(F=document.createElement("SELECT"),F.id="ce113"+l.id,F.style.width="44px",l.appendChild(F),N.us?(r(F,"12",12),Q(F,1,11,!1)):Q(F,0,23,!0));N.h&&N.m&&c();N.m&&(W=w("ce114"+l.id));N.s&&(c(),P=w("ce115"+l.id));N.h&&N.us&&(aa=document.createElement("SELECT"),aa.id="ce116"+l.id,aa.style.width=
"44px",aa.style.marginLeft="4px",l.appendChild(aa),r(aa,"AM","AM"),r(aa,"PM","PM"));(function(){var y=document.createElement("INPUT");y.id="ce112"+l.id;y.type="button";y.style.marginLeft="4px";y.value="OK";l.appendChild(y);y.onclick=function(S){S=S||window.event;S.cancelBubble=!0;d()}})();this.defaultFormat=function(){return"hh:mm tt"};this.getRawValue=function(){return new Date("1/1/2000 "+q()+":"+(N.m?u(W):"00")+":"+(N.s?u(P):"00"))};this.getValue=function(){return H.formatDate(this.getRawValue(),
"HH:mm:ss")};this.getText=function(){var y=(N.h?u(F):"00")+":"+(N.m?u(W):"00")+":"+(N.s?u(P):"00")+(N.h&&N.us?" "+u(aa):"");return H.formatDate(new Date("1/1/2000 "+y),p)};this.setValue=function(y,S,ia){if(H.defined(y)&&H.defined(S)&&H.defined(ia)&&0!=y.length&&0!=S.length&&0!=ia.length){if(N.h)if(N.us){y=parseInt(y,10);var ta=y-12;13>y?(ta=0==y?12:y,n(aa,"AM",!0)):n(aa,"PM",!0);n(F,ta,!0)}else 2>y.length?n(F,y,!0):n(F,y,!1);N.m&&(2>S.length?n(W,S,!0):n(W,S,!1));N.s&&(2>ia.length?n(P,ia,!0):n(P,ia,
!1))}else N.h&&(F.selectedIndex=0),N.m&&(W.selectedIndex=0),N.s&&(P.selectedIndex=0),N.h&&N.us&&(aa.selectedIndex=0)}};$rule.TextBox.Settings=function(l,p,d,n,m,u,r,Q){this.parent=l;this.id=p;this.css=d;this.defCss=n;this.max=m;this.placeholder=u;this.errVal=r;this.errColor=Q};
$rule.TextBox.Control=function(){var l,p;this.init=function(d){p=d;l=document.createElement("INPUT");l.type="text";l.id=p.id;l.className=p.defCss;l.maxLength=p.max;l.placeholder=p.placeholder;p.parent.appendChild(l);l.onfocus=function(n){l.className=$rule.trim(l.className.replace(p.errColor,""));l.className=p.css;l.value.toLowerCase()==p.errVal.toLowerCase()&&(l.value="")};l.onblur=function(n){n=$rule.trim(l.value);if(0==n.length||n.toLowerCase()==p.errVal.toLowerCase())l.className=$rule.trim(l.className.replace(p.errColor,
"")),l.className=p.defCss}};this.getValue=function(){return l.value};this.setValue=function(d){l.value=d};this.setClass=function(d){l.className=d}};$rule.Calendar.Css=function(){this.container="ceCal";this.header="ceHeader";this.day="ceDay";this.today="ceToday";this.selected="ceSelected";this.dayRollover="ceRollover";this.weekDays="ceDays"};
$rule.Calendar.Control=function(l,p){var d=$rule,n,m,u,r,Q=!1,H=d.defined(p)?p:new d.Calendar.Css,N,q,w,c,F=new Date;var W=F.getMonth();var P=F.getFullYear();var aa=F.getHours();var y=F.getMinutes();var S=F.getSeconds();var ia=F.getDate();var ta=N=0;this.show=function(K,J,M,T,X){n=K;u=J;r=d.defined(M)?M:"MMM dd, yyyy";Q=T;d.defined(X)&&(ia=X.getDate(),N=P=X.getFullYear(),ta=W=X.getMonth(),aa=X.getHours(),y=X.getMinutes(),S=X.getSeconds());R();kb();ua()};this.hide=function(){d.defined(c)&&d.defined(c.parentNode)&&
c.parentNode.removeChild(c)};this.position=function(){kb()};this.defaultFormat=function(){return"MMM dd, yyyy"};this.getId=function(){return d.defined(c)?c.id:null};var ua=function(){var K=d.getChildrenByTagName(q.rows[0].cells[1],"SPAN",!1);K[0].innerHTML=d.abbrMonthNames[W];K[1].innerHTML=P;Cb()},Cb=function(){var K=new Date,J=new Date(P,W,1),M=K.getFullYear(),T=K.getMonth();K=K.getDate();J=J.getDay();var X=1,Qa=!0;var ub=1==W&&(0==P%4&&0!=P%100||0==P%400)?29:d.days[W];for(var ma=1;ma<w.rows.length;ma++)for(var Ca=
0;Ca<w.rows[ma].cells.length;Ca++){var ja=w.rows[ma].cells[Ca];Qa=!0;1==ma&&Ca>=J||1<ma&&X<=ub?(ja.innerHTML=X,M==P&&T==W&&X==K&&d.defined(H.today)?(ja.className=H.today,ja.setAttribute("ce117",H.today),Qa=!1):P==N&&W==ta&&X==ia&&d.defined(H.selected)?(ja.className=H.selected,ja.setAttribute("ce117",H.selected),Qa=!1):d.defined(H.day)&&(ja.className=H.day),Qa&&d.defined(H.day)&&ja.setAttribute("ce117",H.day),ja.onclick=function(ka){var Xa=(new d.Time.Settings(r)).dp;Xa||(ka=ka||window.event,ka.cancelBubble=
!0);for(var Db=1;Db<w.rows.length;Db++)for(var Eb=0;Eb<w.rows[Db].cells.length;Eb++)ka=w.rows[Db].cells[Eb],ka.getAttribute("ce117")==H.today?ka.className=H.today:(ka.className=H.day,ka.setAttribute("ce117",H.day));ia=parseInt(d.text(this),10);this.className!=H.today&&d.defined(H.selected)&&(this.className=H.selected,this.setAttribute("ce117",H.selected));Xa||da()},ja.onmouseover=function(ka){d.defined(H.dayRollover)&&(this.className=H.dayRollover)},ja.onmouseout=function(ka){ka=this.getAttribute("ce117");
d.defined(ka)&&(this.className=ka)},X++):(d.defined(H.day)&&(ja.className=H.day),ja.innerHTML="&nbsp;",ja.onclick=ja.onmouseover=ja.onmouseout=null)}},da=function(){var K=W+1+"/"+ia+"/"+P;F=new Date(K);W=F.getMonth();P=F.getFullYear();ia=F.getDate();ta=W;N=P;if((new d.Time.Settings(r)).dp){var J=m.getRawValue();aa=J.getHours();y=J.getMinutes();S=J.getSeconds();K+=" "+aa+":"+y+":"+S}d.defined(u)&&u(K)},R=function(){c=document.createElement("TABLE");c.id="ce120"+n.id;c.setAttribute("ceCalendarControl",
"true");c.cellSpacing=0;c.cellPadding=1;var K=c.insertRow(-1);K=K.insertCell(-1);d.defined(H.container)&&(c.className=H.container);c.style.position="absolute";l&&(c.style.zIndex=$rule.topZindex(document.body));q=document.createElement("TABLE");q.id="ce121"+n.id;q.setAttribute("ce118","true");d.defined(H.header)&&(q.className=H.header);q.cellSpacing=q.cellPadding=0;q.style.width="100%";var J=q.insertRow(-1),M=J.insertCell(-1);M.style.padding="3px 0px 5px 6px";var T=Ma(M,"ce123"+n.id,"&#171;&#171;");
T.style.marginRight="4px";T.onclick=function(X){X=X||window.event;X.cancelBubble=!0;--P;ua()};M=Ma(M,"ce124"+n.id,"&#171;");M.style.marginLeft="2px";M.onclick=function(X){X=X||window.event;X.cancelBubble=!0;0==W?(W=11,--P):--W;ua()};T.style.cursor=M.style.cursor="pointer";M=J.insertCell(-1);M.style.width="90px";M.style.textAlign="center";M.style.padding="3px 0px 5px 0px";T=Ma(M,"ce125"+n.id,d.abbrMonthNames[W]);M=Ma(M,"ce126"+n.id,P);T.style.marginRight="2px";M.style.marginLeft="2px";T.style.cursor=
M.style.cursor="default";T=J.insertCell(-1);T.style.padding="3px 6px 5px 0px";T.style.textAlign="right";J=Ma(T,"ce127"+n.id,"&#187;");J.style.marginRight="2px";J.onclick=function(X){X=X||window.event;X.cancelBubble=!0;11==W?(W=0,++P):++W;ua()};T=Ma(T,"ce128"+n.id,"&#187;&#187;");T.style.marginLeft="4px";T.onclick=function(X){X=X||window.event;X.cancelBubble=!0;++P;ua()};T.style.cursor=J.style.cursor="pointer";K.appendChild(q);w=pa();document.body.appendChild(c);(new d.Time.Settings(r)).dp&&(K=c.insertRow(-1),
K=K.insertCell(-1),K.style.padding="0 4px 6px 4px",K.style.textAlign="center",m=new d.Time.Control(K,r,da),m.setValue(aa,y,S))},pa=function(){var K=document.createElement("TABLE");K.id="ce148"+n.id;K.cellSpacing=1;K.cellPadding=0;K.style.width="100%";for(var J,M,T=0;7>T;T++){J=K.insertRow(-1);for(var X=0;7>X;X++)M=J.insertCell(-1),0==T&&d.defined(H.weekDays)&&(M.className=H.weekDays),M.innerHTML="&nbsp;"}for(J=0;J<K.rows[0].cells.length;J++)K.rows[0].cells[J].innerHTML=d.abbrWeekDayNames[J];c.rows[0].cells[0].appendChild(K);
return K},Ma=function(K,J,M){var T=document.createElement("SPAN");d.defined(J)&&(T.id=J);T.innerHTML=M;K.appendChild(T);return T},kb=function(){d.defined(n)&&(d.position(n,c),Q&&d.leftAlign(n,c))}};$rule.days=[31,28,31,30,31,30,31,31,30,31,30,31];$rule.dayNames="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");$rule.abbrDayNames="Sun Mon Tue Wed Thu Fri Sat".split(" ");$rule.abbrWeekDayNames="SMTWTFS".split("");$rule.monthNames="January February March April May June July August September October November December ".split(" ");
$rule.abbrMonthNames="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec ".split(" ");$rule.init=function(l){data=(new $rule.Json).deserialize(l&&l.d||l);$rule.defined(data.h)&&($rule.Help=data.h);$rule.Errors=data.e;$rule.Context.addControl(data.id,new $rule.Control({element:data.id,asp:!1,z:data.z}));return $ce(data.id)};
$rule.Settings=function(l){this.help=l.ui[0];this.isEval=l.ui[1];this.evalIf=l.ui[2];this.execIf=l.ui[3];this.tools=l.ui[4];this.pb=l.ui[5];this.tochki=l.ui[6];this.clicks=l.ui[7];this.titles=l.ui[8];this.right=l.ui[9];this.mode=l.ui[10];this.tId=l.ui[11];this.tUrl=l.ui[12];this.tCoId=l.ui[13];this.tCoUrl=l.ui[14];this.els=l.s;this.clientFlds=[]};
$rule.Control=function(l){var p=$rule,d,n,m,u,r,Q,H,N,q=null,w,c=null,F=null,W=[],P=[],aa=[],y,S=[],ia=null,ta=null,ua=null,Cb,da,R,pa,Ma,kb,K=null,J,M,T,X,Qa,ub=null,ma=!0,Ca,ja,ka=null,Xa=0,Db=!1,Eb=!1,Fa=null,vb=!1,Ga=null,Za=!1,ea=!1,Da=!1,Y=!1,Na=0,rc=0,sc=0,fa=this,h=p.defined,Fb=new p.Json,gb,tc,ac,Xc=p.getChildrenByAttribute,z=null,bc,Wb,Xb,uc=!1,vc=!1,Gb=null,wc=null,xc=null,yc=null;if(!h(l))throw Error("Params object is expected (CL242)");var C={clientOnly:!1,container:null,form:null,field:null,
id:"ceDefaultID",asp:l.asp||!1,useZindex:l.z||!1,fieldId:l.h||null};if(h(l.element))if("string"===typeof l.element)C.id=l.element;else{if("object"!==typeof l.element)throw Error("Invalid value of the main container (CL246)");C.container=l.element;if(h(l.element.id)&&0<$rule.trim(l.element.id).length)C.id=l.element.id;else throw Error("The editor's container must have id (CL246)");}else throw Error("Pars.element value must be either a DOM element or its id (CL244)");fa.loadSettings=function(a){bc=
a&&a.d||a;Yc();return fa};fa.loadRule=function(a){Xb=a&&a.d||a;if(h(Xb))return zc(),fa};fa.loadInvalids=function(a){Wb=a&&a.d||a;if(h(Wb))return Ac(),fa};fa.setClientActions=function(a,b,g){wc=g;xc=b;yc=a;return fa};fa.getRuleId=function(){return Fa};fa.isEvaluationType=function(){return q?q.isEval:!0};fa.saved=function(a){function b(v,t){return v.Name.localeCompare(t.Name)}function g(v,t){return v.n.localeCompare(t.n)}if(!C.clientOnly)return fa;h(a)&&(Fa=a);h(Fa)&&Fa!=a&&Zc();var e=[],k=!1;if(q.tools){for(var x=
0;x<aa.length;x++)a=aa[x],"ceEval"!=a.ID&&"ceExec"!=a.ID&&(a.ID==Fa&&(a.Name=Pb(T.getValue()),k=!0),e.push({ID:a.ID,Name:a.Name}));k||(a=new p.Menu.Item,a.ID=Fa,a.Name=Pb(T.getValue()),e.push(a));e.sort(b);q.els.rls=e;$c()}if(q.isEval){k=!1;for(e=0;e<z.fds.length;e++)if(a=z.fds[e],a.ir&&a.v==Fa){a.n=Pb(T.getValue());k=!0;break}k||(a={n:Pb(T.getValue()),v:Fa,o:4,t:1,ai:2,ir:!0,l:!1},z.fds.push(a));z.fds.sort(g)}return fa};fa.deleted=function(a){for(var b=[],g,e=0;e<aa.length;e++)g=aa[e],g.ID!=a&&b.push(g);
aa=b;if(q.isEval){b=[];for(e=0;e<z.fds.length;e++)g=z.fds[e],g.v!=a&&b.push(g);z.fds=b}return fa};fa.extract=function(){Gb="ceExtract";vb=!1;return Fb.serialize(cc())};fa.clear=function(){ad();return fa};fa.dispose=function(){Qb();dc("ceMenu");dc("ceTime");p.removeHandlers(window);p.removeHandlers(document);h(C.form)&&p.removeHandlers(C.form);if(h(C.container)&&!h(C.form)){var a=p.getChildrenByAttribute(document.body,"ce","form"+C.container.id);if(h(a)&&0<a.length)try{var b=a[0];document.body.removeChild(b);
var g=document.getElementById(C.fieldId);h(g)&&b.removeChild(g)}catch(e){}}return fa};fa.redraw=function(){bd();return fa};fa.disable=function(){Qb();w=9;return fa};fa.enable=function(){Qb();return fa};fa.init=function(a){bc=a;p.addHandlers(window,{load:Yc},fa)};fa.load=function(a){h(a)&&(Xb=a,p.addHandlers(window,{load:zc},fa))};fa.invalid=function(a){h(a)&&(Wb=a,p.addHandlers(window,{load:Ac},fa))};fa.valid=function(){Bc();Ra()};fa.post=function(){Cc()};var Yc=function(){q=new $rule.Settings(Fb.deserialize(bc));
bc=null;if(!h(q.els.src)||0==q.els.src.length)throw Error("CL87");d=p.Client.ElementType;n=p.Client.FunctionType;H=p.Client.CollectionType;N=p.Client.SelectionType;m=p.Models.OperatorType;u=p.Client.InputType;r=p.Client.CalculationType;Q=p.Common.ValueInputType;gb=$rule.getBounds;tc=p.Client.browser==p.Client.type.IE;ac=p.Client.browser==p.Client.type.Opera;sc=0;C.container=document.getElementById(C.id);C.fieldId?C.field=document.getElementById(C.fieldId):C.clientOnly=!0;Z(null);h(q.els.str)&&q.els.str.length||
(q.els.str=[]);q.els.ens&&0<q.els.ens.length?cd(q.els.ens,!0):q.els.ens=[];q.els.mds&&0<q.els.mds.length?cd(q.els.mds,!1):q.els.mds=[];if(C.clientOnly){if(h(q.tId)&&h(q.tUrl)){var a=Xc(document,q.tId);0<a.length&&(a[0].href=q.tUrl)}h(q.tCoId)&&h(q.tCoUrl)&&(a=Xc(document,q.tCoId),0<a.length&&(a[0].href=q.tCoUrl))}q.els.ms=q.help&&h(p.Help)?p.Help:{};q.els.er=p.Errors;C.asp||C.clientOnly||(C.form=p.getParentByTagName(C.container,"FORM"),h(C.form)&&p.addHandlers(C.form,{submit:Cc},this));a="_"+C.id;
var b=document.getElementById(a);h(b)&&(b.innerHTML="");q.tools?($c(),Id()):(J=document.getElementById("ceT"+C.container.id),h(J)&&J.parentNode.removeChild(J),J=null);if(q.help)if(h(q.els.ms.i101)){var g="ceH"+C.container.id;M=document.getElementById(g);h(M)&&M.parentNode.removeChild(M);M=document.createElement("DIV");M.id=g;M.className="ceHelp";C.container.appendChild(M);M.innerHTML=q.els.ms.i101}else dd();else dd();h(b)||(b=document.createElement("DIV"),b.id=a);b.className="ceRule";C.container.appendChild(b);
C.container=b;ed();w=2;y="";Za=!1;dc("ceMenu");dc("ceTime");Db||(ka=new p.Menu.Control("ceMenu",C.useZindex),Ca=new p.Calendar.Control(C.useZindex),ja=new p.Time.Picker("ceTime",C.useZindex),p.addHandlers(document,{click:Jd},this),p.addHandlers(C.container,{touchstart:Kd},this),p.addHandlers(C.container,{touchend:Ld},this),p.addHandlers(C.container,{touchmove:Md},this),p.addHandlers(C.container,{contextmenu:Nd},this),p.addHandlers(document,{keydown:Od,keypress:Pd,keyup:Qd},this),ka.init(this,q.help?
Ra:null),p.addHandlers(window,{resize:bd},this),Db=!0);vc&&zc();uc&&Ac();uc=vc=!1},zc=function(){if(h(q)){var a=Fb.deserialize(Xb);if(0!=a.length){Fa=a[0].g;q.isEval=a[0].v;if(q.tools){h(Fa)&&Zc();var b=a[0].n,g=a[0].d;h(b)&&0<b.length?(T.setValue(Yb(b)),T.setClass("ceNameBox")):(T.setValue(""),T.setClass("ceNameBoxDefault"));h(g)&&0<g.length?(X.setValue(Yb(g)),X.setClass("ceDescriptionBox")):(X.setValue(""),X.setClass("ceDescriptionBoxDefault"))}Xa=a.length+1;fd();for(var e,k,x=null,v=null,t=0,A=
0,E,O=null,Sa=1;Sa<a.length;Sa++){b=a[Sa];if(!h(b))break;E=!1;if(b.t==d.NewLine)wb(!1,!0);else if(b.t==d.Tab)ba({t:b.t,id:null,v:"",n:"&nbsp;",st:null,ct:null,ft:null,fv:!1,it:null,h:!0});else{g=h(b.n)?b.n:null;switch(b.t){case d.Flow:k=G(q.els.fls,b.v);if(!h(k)){alert("This rule cannot be properly loaded using the current Mode");return}switch(b.v){case "if":e=q.isEval?q.evalIf:q.execIf;break;case "elseIf":e=4==q.mode?q.isEval?q.evalIf:q.execIf:k.n;break;default:e=k.n}break;case d.LeftSource:e=q.els.lbl.ub;
break;case d.RightSource:e=q.els.lbl.ue;break;case d.LeftParenthesis:e=q.els.lbl.pb;break;case d.RightParenthesis:e=q.els.lbl.pe;break;case d.LeftBracket:e=q.els.lbl.cb;break;case d.RightBracket:e=q.els.lbl.ce;break;case d.Action:case d.Function:switch(b.f){case n.Name:A=0;F=null;if(b.d)t=0,e=b.v,E=!0;else{k=G(b.t==d.Action?z.acs:z.fds,b.v);if(!h(k))throw Error("CL11");e=0<k.ps.length?k.n+"&nbsp;(":k.n;t=k.ps.length;b.t==d.Function&&(k.rt.o==m.Enum?F=Hb(k.rt.e):k.rt.o==m.Numeric&&h(k.rt.mds)?F=xb(k.rt.mds,
k.ftr):k.rt.o==m.Date?x=k.rt.f:k.rt.o==m.Time&&(v=k.rt.f))}break;case n.Param:if(b.i==u.Field)k=G(z.fds,b.v),h(k)?e=k.n:(e=b.v,E=!0);else if(b.o==m.String)e=p.encode(p.decode(b.v));else if(b.o==m.Numeric)k=Aa(c),k.ps.length>=A&&h(k.ps[A].mds)?(e=xb(k.ps[A].mds,k.ps[A].ftr),h(e)&&0<e.length?(b.i=u.Field,e=G(e,b.v),h(e)?e=e.Name:(e=b.v,E=!0)):(E=!0,e=b.v)):e=b.v;else if(b.o==m.Date)e=p.formatDate(new Date(b.v),h(b.r)?b.r:Ca.defaultFormat());else if(b.o==m.Time)e=p.formatDate(new Date("1/1/2010 "+b.v),
h(b.r)?b.r:ja.defaultFormat());else if(b.o==m.Enum)e=G(Hb(b.e),b.v),h(e)?e=e.Name:(e=b.v,E=!0);else if(b.o==m.Bool)e=Zb(b.v);else throw Error("CL22");A++;break;case n.Comma:e=",";break;case n.End:e=0<t?")":"&nbsp;";t=A=0;break;default:throw Error("CL36");}break;case d.Calculation:switch(b.c){case r.Function:switch(b.f){case n.Name:A=0;F=null;if(b.d)t=0,e=b.v,E=!0;else{k=G(z.fds,b.v);if(!h(k))throw Error("CL11");e=0<k.ps.length?k.n+"&nbsp;(":k.n;t=k.ps.length;if(k.rt.o!=m.Numeric)throw Error("CL13");
h(k.rt.mds)&&(F=xb(k.rt.mds,k.ftr))}break;case n.Param:if(b.i==u.Field)k=G(z.fds,b.v),h(k)?e=k.n:(e=b.v,E=!0);else if(b.o==m.String)e=p.encode(p.decode(b.v));else if(b.o==m.Numeric)k=Aa(c),k.ps.length>=A&&h(k.ps[A].mds)?(e=xb(k.ps[A].mds,k.ps[A].ftr),h(e)&&0<e.length?(b.i=u.Field,e=G(e,b.v),h(e)?e=e.Name:(e=b.v,E=!0)):(E=!0,e=b.v)):e=b.v;else if(b.o==m.Date)e=p.formatDate(new Date(b.v),h(b.r)?b.r:Ca.defaultFormat());else if(b.o==m.Time)e=p.formatDate(new Date("1/1/2010 "+b.v),h(b.r)?b.r:ja.defaultFormat());
else if(b.o==m.Enum)e=G(Hb(b.e),b.v),h(e)?e=e.Name:(e=b.v,E=!0);else if(b.o==m.Bool)e=Zb(b.v);else throw Error("CL22");A++;break;case n.Comma:e=",";break;case n.End:e=0<t?")":"&nbsp;";t=A=0;break;default:throw Error("CL36");}break;case r.Field:k=G(z.fds,b.v);h(k)?e=k.n:(e=b.v,E=!0);break;case r.Number:e=b.v;break;case r.LeftParenthesis:e=q.els.lbl.pb;break;case r.RightParenthesis:e=q.els.lbl.pe;break;case r.Multiplication:e="&#215;";break;case r.Division:e="&#247;";break;case r.Addition:e="&#43;";
break;case r.Subtraction:e="&#150;";break;default:throw Error("CL90");}break;case d.Field:b.d?(e=b.v,F=x=v=null,E=!0):(k=G(z.fds,b.v),h(k)?(F=b.o==m.Enum||b.o==m.Collection&&k.co==m.Enum?h(k.e)?Hb(k.e):k.ens:(b.o==m.Numeric||b.o==m.Collection&&k.co==m.Numeric)&&h(k.mds)?xb(k.mds,k.ftr):null,x=b.o==m.Date&&h(k.f)?k.f:null,v=b.o==m.Time&&h(k.f)?k.f:null,e=k.n):(e=b.v,F=x=v=null));break;case d.Exists:h(b.v)||(b.v=b.y==N.DoesNotExist?"ce803":"ce802");e=Dc(b.v);break;case d.Where:e=Ib(q.els.dsc,"where");
break;case d.Clause:e=G(q.els.cls,b.v);if(h(e))e=G(q.els.cls,b.v).n;else{alert("This rule cannot be properly loaded using the current Mode");return}break;case d.Setter:e=Ib(q.els.str,b.v);break;case d.Operator:e=gd(b.v,b.o);h(e)?e=e.n:(e="is",E=!0);break;case d.Value:b.o==m.Enum?h(F)&&0!=F.length?(k=G(F,b.v),h(k)?e=k.Name:(k=G(z.fds,b.v),h(k)?e=k.n:(e=b.v,E=!0))):(e="[Unknown]",E=!0):b.i==u.Field?(k=G(z.fds,b.v),h(k)?e=k.n:(e=b.v,E=!0)):b.o==m.String?e=0==b.v.length?q.els.lbl.em:p.encode(p.decode(b.v)):
b.o==m.Numeric?h(F)&&0<F.length?(b.i=u.Field,e=G(F,b.v),h(e)?e=e.Name:(e=b.v,E=!0)):e=b.v:e=b.o==m.Date?p.formatDate(new Date(b.v),h(x)?x:Ca.defaultFormat()):b.o==m.Time?p.formatDate(new Date("1/1/2010 "+b.v),h(v)?v:ja.defaultFormat()):Zb(b.v)}ba({t:b.t,id:g,v:b.v,n:e,st:b.o,ct:b.c,co:b.co,cn:b.cn,ft:b.f,it:b.i,h:!0,fv:b.q});b.t!=d.LeftSource&&b.t!=d.RightSource||Z(c);yb(b.t,b.o,b.c,b.i)&&Oa();E&&(c.className+=" ceWarn",O=q.els.er.e107)}}F=Xb=null;w=0;Qb();h(O)&&alert(O)}}else vc=!0},Ac=function(){if(h(q)){var a=
Fb.deserialize(Wb);if(0!=a.length){a[0].e&&h(T)&&(T.setValue(q.els.er.e104),T.setClass("ceNameBox ceError"));for(var b=1;b<a.length;b++){var g=a[b],e=document.getElementById(g.c||g.ClientID);h(e)&&(e.className+=" ceHighlight",e.title=g.h||g.Hint,W.push(e.id))}q.help&&(1<a.length?(Jb(q.els.er.e102),M.className+=" ceError"):a[0].e&&(Jb(q.els.er.e103),M.className+=" ceError"));Wb=null}}else uc=!0},Cc=function(){C.clientOnly||(vb=!1,C.field.value=Fb.serialize(cc()))},cc=function(){if(0<p.getChildrenByTagName(C.container,
"INPUT",!1).length)Rb(q.els.er.e114);else{Z(null);var a=bb(),b=!1,g=new p.Models.RuleModel;g.Elements=[];h(Fa)&&(g.Id=Fa);g.IsLoadedRuleOfEvalType=q.isEval;g.Command=Gb;g.Mode=q.mode;if(!vb){if(q.tools){var e=T.getValue();g.Name=0==p.trim(e).length||p.trim(e).toLowerCase()==q.els.er.e104.toLowerCase()?null:Pb(e);e=X.getValue();g.Desc=0==p.trim(e).length||p.trim(e).toLowerCase()==q.els.er.e104.toLowerCase()?null:Pb(e);g.SkipNameValidation=!1}else g.SkipNameValidation=!0;for(var k=0;k<a.length;k++){var x=
a[k];var v=D(x);if(h(v)&&v!=d.HtmlTag){e=new p.Client.Element;e.Type=v;e.Name=x.id;e.Oper=Ba(x,!0);e.FuncType=U(x);e.InpType=Ua(x);e.CalType=qa(x);switch(v){case d.Field:e.Value=x.getAttribute("ce208");e.IsRule="true"==x.getAttribute("ce213");v=G(z.fds,e.Value);b=h(v)&&h(v.mds);switch(e.Oper){case m.String:h(v)&&(e.Max=v.max);break;case m.Numeric:h(v)&&(e.Dec=v.dec,e.Cal=v.cal,e.Min=v.min,e.Max=v.max,h(v.mds)&&(e.InpType=u.Input,b=!0));break;case m.Date:case m.Time:h(v)&&(e.Format=v.f);break;case m.Enum:h(v)&&
(e.En=v.e);break;case m.Collection:if(h(v)&&(e.CollType=v.ct,v.ct==H.Value))switch(v.co){case m.String:e.Max=v.max;break;case m.Numeric:e.Dec=v.dec;e.Cal=v.cal;e.Min=v.min;e.Max=v.max;v.co==m.Numeric&&h(v.mds)&&(e.InpType=u.Input,b=!0);break;case m.Date:case m.Time:e.Format=v.f;break;case m.Enum:e.En=v.e}}break;case d.LeftSource:Z(x);e.Value=x.getAttribute("ce208");break;case d.RightSource:Z(x);e.Value=x.getAttribute("ce208");break;case d.Value:e.Value=$rule.decode(x.getAttribute("ce206"),!0);e.Oper==
m.Numeric&&b&&(v=G(z.fds,e.Value),h(v)||(e.InpType=u.Input));b=!1;break;case d.Calculation:h(x.getAttribute("ce206"))&&(e.Value=x.getAttribute("ce206"));break;case d.Action:case d.Function:if(v==d.Function&&e.FuncType==n.Name)e.Value=x.getAttribute("ce208"),e.IsFuncValue="true"==x.getAttribute("ce216"),v=G(z.fds,e.Value),b=h(v)&&h(v.rt.mds);else if(e.FuncType==n.Param){var t=x;v=e.Oper;var A=Aa(t);var E=null;h(A)&&(t=lb(t),E=0<=t&&A.ps.length>=t&&A.ps[t].o==v?A.ps[t]:hd(A,v,0>t?0:t));A=E;if(e.InpType==
u.Input){if(h(A))switch(e.Oper){case m.String:e.Max=A.max;break;case m.Numeric:e.Dec=A.dec;e.Min=A.min;e.Max=A.max;break;case m.Date:case m.Time:e.Format=A.f;break;case m.Enum:e.En=A.e}h(x.getAttribute("ce206"))&&(e.Value=x.getAttribute("ce206"))}else e.Value=x.getAttribute("ce208"),v=G(z.fds,e.Value),h(A)&&A.o==m.Numeric&&h(A.mds)&&!h(v)&&(e.InpType=u.Input)}else e.Value=x.getAttribute("ce208"),v==d.Function&&(e.IsFuncValue="true"==x.getAttribute("ce216"),G(z.fds,e.Value));break;case d.Exists:case d.Where:switch(x.getAttribute("ce208")){case "ce803":e.SelType=
N.DoesNotExist;break;default:e.SelType=N.Exists}v=mb(x,d.Field);h(v)?(v=G(z.fds,v.getAttribute("ce208")),h(v)?e.CollType=v.ct:e.CollType=H.Generic):e.CollType=H.Generic;e.Value=x.getAttribute("ce208");break;default:e.Value=x.getAttribute("ce208")}g.Elements.push(e)}}}return g}},Md=function(a){a.preventDefault();a.stopPropagation();return!1},Nd=function(a){a.preventDefault();a.stopPropagation();return!1},Kd=function(a){if(9==w)return!1;ua=a.target;pa=R=kb=0;Ma=(new Date).getTime();a.changedTouches&&
(a=a.changedTouches[0],Cb=a.pageX,da=a.pageY);K=setTimeout(function(){0===kb&&(h(ua)&&h(ua.getAttribute("ce202"))?id({keyCode:13}):Ec({keyCode:32}));K=null},600)},Ld=function(a){h(K)&&clearTimeout(K);K=null;a.changedTouches&&(a=a.changedTouches[0],R=a.pageX-Cb,pa=a.pageY-da,250>=(new Date).getTime()-Ma&&(60<=Math.abs(R)&&30>=Math.abs(pa)?kb=0>R?4:2:60<=Math.abs(pa)&&30>=Math.abs(R)&&(kb=0>pa?1:3)));switch(kb){case 2:Fc({keyCode:127});break;case 3:Ec({keyCode:32});break;case 4:Fc({keyCode:8})}},Wd=
function(a){function b(L){Pa(L)?hb(L):c=I(L)}function g(L){L=Gc(c,n.End);h(L)&&(c=I(L),pb())}function e(L,Ha){var ha=$a(c),wa=null;if(ha&&(wa=xa(L.previousSibling),D(wa)==d.Function)){var na=Sb(wa,n.Name);if(!h(na))return;wa=xa(na.previousSibling)}na=[];if(qa(c)==r.Function)for(ha=ec(Ha),V("ce801",m.Numeric,qb(m.Numeric),na),wa=0;wa<ha.length;wa++)na.push(ha[wa]);else{na=Ba(L,!0);wa=!ha||D(wa)==d.Setter&&"to"==wa.getAttribute("ce208");var ca=G(z.fds,Ha);if(h(ca)){var Kb=h(ca.ftr)?ca.ftr:null;ca=ca.t==
d.Function?ca.rt:ca;var Hc=ca.o;var jd=ca.co;var Ic=ca.e;var Jc=ca.mds;h(ca.mds)&&(Kb=null);var Rd=ca.cc;var Sd=ca.cl;var Td=ca.cv;var Lb=[];if(h(ca)&&"true"==c.getAttribute("ce216")){var la=ca.t==d.Function?ca.rt.ai:ca.ai,rb=ca.t==d.Function?ca.rt.o:ca.o;(rb==m.Numeric&&ca.t==d.Function?ca.rt.cal:ca.cal)&&V("C",rb,q.els.lbl.c,Lb);la==Q.All&&V("ce801",rb,qb(rb),Lb)}for(ca=0;ca<z.fds.length;ca++)la=z.fds[ca],la.ir&&ha||ha&&h(la.st)&&!la.st||la.ir&&(h(Fa)&&la.v==Fa||na!=m.Bool)||la.v==Ha||(rb=h(la.ftr)?
la.ftr:null,la.t==d.Function?wa&&(la.rt.o!=na||Hc==m.Enum&&Ic!=la.rt.e||la.mds!=Jc||null!=Kb&&"any"!=Kb&&Kb!=rb&&"any"!=rb||Lb.push(la)):Hc==m.Collection&&la.o==m.Collection?la.ct==H.Reference&&la.cc==Rd&&la.cl==Sd&&la.cv==Td?Lb.push(la):la.ct!=H.Value||la.co!=jd||jd==m.Enum&&Ic!=la.e||la.mds!=Jc||Lb.push(la):la.o!=na||Hc==m.Enum&&Ic!=la.e||la.mds!=Jc||null!=Kb&&"any"!=Kb&&Kb!=rb&&"any"!=rb||Lb.push(la));na=Lb}else na=[]}0<na.length?(ea=!0,B(na,L,x,null)):$a(c)||(Da=!1,ha=G(z.fds,Ha),h(ha)&&(ha.t==
d.Function?0<ha.ps.length?(c=I(L),ib(ha)):Tb(ha):ha.o==m.Collection&&ha.ct!=H.Value||B(sb(ha),L,nb,null)))}function k(L,Ha){for(var ha=[],wa,na=0;na<z.acs.length;na++)wa=z.acs[na],wa.v!=Ha&&ha.push(wa);1<ha.length||1==ha.length&&ha[0].v!=Ha?(ea=!0,B(ha,L,v,null)):(Da=!1,ha=fc(),0<ha.length&&B(ha,c,gc,null))}function x(L,Ha){var ha="true"==c.getAttribute("ce216"),wa=qa(c)==r.Function;D(c)==d.Function||D(c)==d.Calculation&&U(c)==n.Name?g(L):Y=!0;if("ce801"==L)switch(parseInt(Ha,10)){case m.Numeric:cb({t:wa?
d.Calculation:d.Value,v:"",st:m.Numeric,ct:wa?r.Number:r.None,ft:n.None,span:c});break;default:$b(xa(c))}else if("C"==L)Kc(L);else{var na=G(z.fds,L);na.t==d.Function?Ub({t:wa?d.Calculation:na.t,m:L,v:ha}):wa?Ia(r.Field,L):ha?kd(na,L,wa):(tb(na,null),!ra()||$a(c)||na.o==m.Collection&&na.ct!=H.Value||B(sb(na),c,nb,null))}}function v(L){g(L);Ub({t:G(z.acs,L).t,m:L,v:!1})}if(9==w)return!1;Y=ea=Da=Za=!1;var t=a.target;if(h(p.getParentById(t,C.container.id))){Z(c);(h(c)&&t.id!=c.id&&"INPUT"==c.tagName||
"INPUT"!=t.tagName)&&Oa();Na=0;if(6==w||8==w){ka.close();w=ld()?0:2;return}if(4==w)zb(),w=0;else if(3==w)Ab(),w=0;else if(2==w||1==w&&!h(c))fd(),ba({t:d.Flow,id:null,v:"if",n:q.isEval?q.evalIf:q.execIf,st:null,ct:null,ft:null,it:null,h:!1,fv:!1}),c=I(c),B(Ja(),c,Ka,d.LeftParenthesis);else{if(a.ctrlKey||a.metaKey)return"true"==t.getAttribute("ce218")?(t.className=p.trim(t.className.replace("ceSelected","")),t.setAttribute("ce218","false")):(t.className=p.trim(t.className)+" ceSelected",t.setAttribute("ce218",
"true")),t=p.getChildrenByAttribute(C.container,"ce218","true"),0<t.length?Ra("i137"):Ra(),!1;hc();var A=!0;if(h(t.getAttribute("ce202"))){if(0==w&&"INPUT"==t.tagName)return!0;a=qa(t);var E=Ua(t),O=Ba(t,!0);yb(D(t),O,a,E)&&E!=u.Field?cb({t:D(t),v:t.getAttribute("ce206"),st:O,ct:a,ft:U(t),span:t,pi:lb(c)}):b(t)}else{Oa();A=!1;t=bb();O=!1;for(var Sa=p.Client.browser==p.Client.type.IE&&9>p.Client.version?p.getScrollHeight():0,jb=0;jb<t.length;jb++){if(!h(t[jb].nextSibling)){b(t[jb]);O=!0;break}E=gb(D(t[jb].nextSibling)==
d.HtmlTag?t[jb].nextSibling.nextSibling:t[jb].nextSibling);if(E.y>a.offsetY+Sa){b(t[jb]);O=!0;break}}!O&&0<t.length&&b(t[t.length-1])}Da=q.clicks&&h(c)&&A&&!h(c.getAttribute("ce207"));Z(c);va();w=0;if(Da)switch(A=c.getAttribute("ce208"),D(c)){case d.Flow:"else"==A?B(db(),c,eb,null):B(Ja(),c,Ka,d.LeftParenthesis);break;case d.Function:switch(U(c)){case n.Param:A=Aa(c);Y=ea=!0;ib(A);break;case n.Name:e(c,A);break;case n.End:Pa(c)&&e(c.previousSibling,A)}break;case d.Field:e(c,A);break;case d.LeftParenthesis:case d.LeftSource:B(Ja(),
c,Ka,d.LeftParenthesis);break;case d.RightParenthesis:case d.RightBracket:case d.RightSource:B(sa(),c,oa,d.RightParenthesis);break;case d.Action:switch(U(c)){case n.Param:A=Aa(c);Y=ea=!0;ib(A);break;case n.Name:k(c,A);break;case n.End:Pa(c)&&k(c.previousSibling,A)}break;case d.Setter:"set"==A?B(Mb(),c,Nb,null):fb(xa(c));break;case d.LeftBracket:B(Va(),c,Ia,null);break;case d.Calculation:a=[];switch(qa(c)){case r.LeftParenthesis:Y=ea=!1;B(Va(),c,Ia,null);break;case r.RightParenthesis:Y=ea=!1;B(Va(),
c,Ia,null);break;case r.Function:switch(U(c)){case n.Name:e(c,A);break;case n.End:Pa(c)&&e(c.previousSibling,A)}break;case r.Field:md(A);break;case r.Addition:V(r.Subtraction,null,"&#150;",a);V(r.Multiplication,null,"&#215;",a);V(r.Division,null,"&#247;",a);Y=ea=!0;B(a,c,Ia,null);break;case r.Subtraction:V(r.Addition,null,"&#43;",a);V(r.Multiplication,null,"&#215;",a);V(r.Division,null,"&#247;",a);Y=ea=!0;B(a,c,Ia,null);break;case r.Multiplication:V(r.Addition,null,"&#43;",a);V(r.Subtraction,null,
"&#150;",a);V(r.Division,null,"&#247;",a);Y=ea=!0;B(a,c,Ia,null);break;case r.Division:V(r.Addition,null,"&#43;",a),V(r.Subtraction,null,"&#150;",a),V(r.Multiplication,null,"&#215;",a),Y=ea=!0,B(a,c,Ia,null)}break;case d.Operator:a=Ya(c);h(a)&&(a=G(z.fds,a.getAttribute("ce208")),h(a)&&(a=sb(a,A),h(a)&&0<a.length?(Y=ea=!0,B(a,c,nb,null)):(Da=!1,"isNull"==A||"isNotNull"==A?B(sa(),c,oa,d.RightParenthesis):fb(xa(c)))));break;case d.Clause:"then"==A?B(db(),c,eb,null):$a(c)?B(db(),c,eb,null):(A=Ud(A),h(A)&&
0<A.length?(Y=ea=!0,B(A,c,oa,null)):B(Ja(),c,Ka,d.LeftParenthesis));break;case d.Exists:a=[];switch(A){case "ce803":V("ce802",d.Field,q.els.lbl.h,a);break;default:V("ce803",d.Field,q.els.lbl.l,a)}Y=ea=!0;B(a,c,Vd,null);break;case d.Value:qa(c)==r.Function?md(A):(A=Ba(c,!0),Y=A!=m.Date&&A!=m.Time,ea=!0,fb(xa(c)))}}Ra()}else 8==w?(hc(),Oa(),Z(c),t.id!=Qa.id&&(ka.close(),w=1),Ra()):(hc(),Oa(),A=Ca.getId(),3==w&&null!=A&&h(p.getParentById(t,A))||Qb(),h(C.container)&&h(C.container.childNodes)&&1<C.container.childNodes.length&&
Ra("i102"));return!0},id=function(a){if(9==w)return!1;ma=!0;Y=ea=Da=!1;if(1==w||2==w)return Z(),!0;var b=a.keyCode;if(16==b||17==b||18==b)return 6==w?ka.close():3==w?Ab():4==w&&zb(),w=0,!0;a.ctrlKey||a.metaKey?y="":(hc(),Z(c));if(27==b||0!=w&&(8==b||127==b))ma=!1;32==b&&0<y.length&&(y+=" ");6!=w&&8!=w||40!=b||rc++;if((6==w||8==w)&&37!=b&&39!=b&&(38!=b||0<rc))return!0;if(4==w||3==w){if(13==b)return!0;4==w?zb():Ab();w=0}var g=D(c),e=Ba(c,!0);switch(b){case 9:y="";g!=d.NewLine&&g!=d.Tab||ba({t:d.Tab,
id:null,v:"",n:"&nbsp;",st:null,ct:r.None,ft:null,it:null,h:!1,fv:!1});ma=!1;break;case 13:y="";g==d.Calculation&&qa(c)==r.Number?h(c.getAttribute("ce207"))?(Oa(),c=I(c),va(),ra()&&B(Va(),c,Ia,null)):(a.ctrlKey||a.metaKey)&&Ua(c)!=u.Field?cb({t:g,v:c.getAttribute("ce206"),st:e,ct:r.Number,ft:U(c),span:c}):wb(!1):g==d.Value?e==m.String||e==m.Numeric?h(c.getAttribute("ce207"))?(Oa(),c=I(c),va(),ra()&&B(sa(),c,oa,d.RightParenthesis)):(a.ctrlKey||a.metaKey)&&Ua(c)!=u.Field?cb({t:g,v:c.getAttribute("ce206"),
st:e,ct:qa(c),ft:U(c),span:c}):wb(!1):wb(!1):g==d.Function||g==d.Action?e==m.String||e==m.Numeric?h(c.getAttribute("ce207"))?(Oa(),c=I(c),va(),ib(Aa(c))):(a.ctrlKey||a.metaKey)&&Ua(c)!=u.Field&&cb({t:D(c),v:c.getAttribute("ce206"),st:Ba(c,!0),ct:qa(c),ft:U(c),span:c,pi:lb(c)}):Pa(c)?(hb(c),wb(!1)):U(c)==n.End&&wb(!1):Vb(c)&&(h(c.nextSibling)&&U(c.nextSibling)==n.End&&0==Aa(c).ps.length&&(g=ic(c),h(g)&&(c=g)),wb(!1));ma=!1;break;case 88:if(a.ctrlKey||a.metaKey)return nd(!0,"i139"),ma=!1;break;case 67:if(a.ctrlKey||
a.metaKey)return nd(!1,"i138"),ma=!1;break;case 86:if((a.ctrlKey||a.metaKey)&&0<S.length){6==w?ka.close():3==w?Ab():4==w&&zb();a=h(c)&&h(c.nextSibling);b=[];g=0;for(var k;g<S.length;g++)k=S[g],k.id=C.container.id+Xa,Xa++,a?C.container.insertBefore(k,c.nextSibling):C.container.appendChild(k),c=I(k),b.push(c.cloneNode(!0));S=b;return ma=!1}break;case 34:Na=0;Oa();g=bb();c=I(g[g.length-1]);g=gb(c);Lc(g.y,g.height);Pa(c)&&hb(c);Z(c);va();ma=!1;break;case 35:Na=0;Oa();g=mb(c,d.HtmlTag);h(g)?c=I(g.previousSibling):
(g=bb(),c=I(g[g.length-1]));Pa(c)&&hb(c);Z(c);va();ma=!1;break;case 33:Na=0;Oa();c=I(bb()[0]);Z(c);jc(gb(c).y);va();ma=!1;break;case 36:Na=0;Oa();g=Mc(c,d.NewLine);if(!h(g)&&(g=bb()[0],"if"!=g.getAttribute("ce208")))throw Error("CL02");c=I(g);Z(c);va();ma=!1;break;case 38:6!=w&&8!=w||Ta();yb(g,e,qa(c),Ua(c))&&h(c.getAttribute("ce207"))&&(Oa(),c=I(c));if(a.ctrlKey||a.metaKey)ia=c.id;e=bb();var x=gb(c),v=null;0==Na&&(Na=x.x+x.width);var t=!1;for(g=e.length-1;-1<g;g--)if(t){var A=e[g];var E=D(A);if(h(v)&&
(E==d.NewLine||ab(A))){c=I(A);jc(k.y);break}k=gb(A);if(!(k.y>x.y-parseInt(k.height/2,10)))if(h(v)||(v=A),Na>k.x+k.width||!h(A.previousSibling)||gb(A.previousSibling).y<k.y){c=I(A);jc(k.y);break}else if(E=k.x+parseInt(k.width/2,10),Na>E){jc(k.y);c=I(A);break}}else t=e[g].id==c.id;Pa(c)&&hb(c);Z(c);va();if(a.ctrlKey||a.metaKey)k=D(c),k==d.Flow&&ab(c)&&(c=I(Wa(c.nextSibling)),Z(c)),kc(!1),Ra("i137");ma=!1;break;case 40:yb(g,e,qa(c),Ua(c))&&h(c.getAttribute("ce207"))&&(Oa(),c=I(c));g=!1;if(a.ctrlKey||
a.metaKey)k=D(c),k==d.Flow&&ab(c)&&(c=I(Wa(c.nextSibling)),Z(c),g=!0),k=xa(c),!Vb(c)&&D(k)==d.Flow&&ab(k)&&(c=I(Wa(c.nextSibling)),Z(c),g=!0),ia=c.id;if(!g){g=bb();k=gb(c);0==Na&&(Na=k.x+k.width);v=!1;for(A=g.length-1;-1<A;A--){x=g[A];if(x.id==c.id)break;e=gb(x);v||(v=e.y-k.height-parseInt(k.height/2,10)<k.y);if(v)if(t=gb(x.previousSibling),Na>e.x+e.width||!h(t)||t.y<e.y){c=I(x);Lc(e.y,e.height);break}else if(t=e.x+parseInt(e.width/2,10),Na>=t){c=I(x);Lc(e.y,e.height);break}}Pa(c)&&hb(c);Z(c);va()}if(a.ctrlKey||
a.metaKey)kc(!0),Ra("i137");ma=!1;break;case 37:Na=0;ma=!1;6!=w&&8!=w||Ta();if("INPUT"==c.tagName)return!1;if(h(c.previousSibling)){e=!1;g=null;if(a.ctrlKey||a.metaKey)if(x=xa(c.previousSibling),k=D(x),k==d.Flow&&ab(x)){if(e=!0,h(c.nextSibling)&&(k=D(c),k==d.Tab||k==d.NewLine||k==d.HtmlTag))c=I(Wa(c.nextSibling)),Z(c)}else ia=c.id;!e&&(h(c.previousSibling)&&(k=D(c.previousSibling),c=I(k==d.HtmlTag?c.previousSibling.previousSibling:c.previousSibling),Z(c)),Pa(c)&&(U(c)==n.End?hb(c):c=I(c.previousSibling)),
e=xa(c),k=D(e),(a.ctrlKey||a.metaKey)&&k==d.Flow&&ab(e)?h(c.nextSibling)&&(k=Wa(c.nextSibling),c=I(k),Z(c)):Z(c),va(),a.ctrlKey||a.metaKey)&&(kc(!1),g="i137");Ra(g)}break;case 39:Na=0;ma=!1;6!=w&&8!=w||Ta();if(!a.ctrlKey&&!a.metaKey)if(g==d.Value&&(e==m.String||e==m.Numeric)){if(h(c.getAttribute("ce207")))return!1;c=I(c);va()}else if(g==d.Calculation&&Ua(c)==u.Input&&qa(c)==r.Number){if(h(c.getAttribute("ce207")))return!1;c=I(c);va()}else{if(!(g!=d.Function&&g!=d.Action||Ua(c)!=u.Input||e!=m.String&&
e!=m.Numeric)){if(h(c.getAttribute("ce207")))return!1;c=I(c);va()}}else if("INPUT"==c.tagName)return!1;if(h(c.nextSibling))if(a.ctrlKey||a.metaKey||!Pa(c.nextSibling)){g=!1;if(a.ctrlKey||a.metaKey)k=D(c),k==d.Flow&&ab(c)&&(c=I(Wa(c.nextSibling)),Z(c),g=!0),k=xa(c),!Vb(c)&&D(k)==d.Flow&&ab(k)&&(c=I(Wa(c.nextSibling)),Z(c),g=!0),ia=c.id;g||(c=D(c.nextSibling)==d.HtmlTag?I(c.nextSibling.nextSibling):I(c.nextSibling),Z(c));if(a.ctrlKey||a.metaKey)kc(!0),Ra("i137");else{g=D(c);k=ra();if(h(c.nextSibling)||
g!=d.RightBracket)if(g!=d.Function&&g!=d.Action||!k)g==d.Flow&&k?"else"==c.getAttribute("ce208")?B(db(),c,eb,null):B(Ja(),c,Ka,d.LeftParenthesis):g!=d.LeftParenthesis&&g!=d.LeftSource||!k?g!=d.RightParenthesis&&g!=d.RightSource&&g!=d.RightBracket&&g!=d.Value||!k?g==d.Field&&k?$a(c)||(g=c.getAttribute("ce208"),G(z.fds,g).ct!=H.Reference&&B(sb(G(z.fds,g)),c,nb,null)):g==d.Exists&&k?B(Nc(mb(c,d.Field).getAttribute("ce208")),c,Oc,null):g==d.Setter&&k?"set"==c.getAttribute("ce208")?B(Mb(),c,Nb,null):(fb(xa(c)),
od()&&B(sa(),c,oa,null)):g==d.Operator&&k?"isNull"==c.getAttribute("ce208")||"isNotNull"==c.getAttribute("ce208")?B(sa(),c,oa,d.RightParenthesis):(fb(c,!0),od()&&B(sa(),c,oa,d.RightParenthesis)):g==d.Clause&&k?"then"==c.getAttribute("ce208")||$a(c)?B(db(),c,eb,null):B(Ja(),c,Ka,d.LeftParenthesis):g!=d.LeftBracket&&g!=d.Calculation||!k||B(Va(),c,Ia,null):B(sa(),c,oa,d.RightParenthesis):(g==d.LeftSource&&Z(c),B(Ja(),c,Ka,d.LeftParenthesis));else switch(U(c)){case n.End:Tb(Aa(c));break;case n.Name:g=
Aa(c),0<g.ps.length&&U(c.nextSibling)==n.End&&ib(g)}else B(sa(),c,oa,d.RightParenthesis);Ra()}}else hb(c.nextSibling),Z(c),va(),Tb(Aa(c))}if(ac)return 8==b&&a.preventDefault(),!1;if(tc&&13==b||8==b&&!h(c.getAttribute("ce207"))||9==b||33==b||34==b||35==b||36==b||38==b||39==b||40==b)a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation();return ma},Ec=function(a){if(9==w)return!1;var b=a.keyCode;Za=!1;if(!ma)return ma=!0,ac?(9!=b&&13!=b&&33!=b&&34!=b&&35!=b&&36!=b&&38!=b&&40!=b||
a.preventDefault(),!1):!0;if(1==w||2==w)return!0;if((6==w||8==w)&&!La(b)||(6==w||8==w)&&38==b)return!1;if(3!=w&&4!=w){var g=y;y="";if(8==w)32==b?(ea=!0,B(aa,Qa,lc,null),w=8):La(b)&&(y=g+=String.fromCharCode(b),ea=!0,ya(aa,Qa,lc,null),w=8);else{var e=xa(c);switch(D(e)){case d.Flow:"else"==e.getAttribute("ce208")?32==b?B(db(),c,eb,null):La(b)&&(y=g+=String.fromCharCode(b),ya(db(),c,eb,null)):32==b?B(Ja(),c,Ka,d.LeftParenthesis):La(b)&&(y=g+=String.fromCharCode(b),ya(Ja(),c,Ka,d.LeftParenthesis),Za=
!0);break;case d.Function:case d.Action:if(Pc(b))switch(U(e)){case n.End:if(32==b)Tb(Aa(e));else if(La(b)){var k=Aa(e);if(ra()&&(g=k.t==d.Function?sb(k):fc(),0<g.length)){k=k.t==d.Function?nb:gc;var x=pd(g,y);0<x.length?B(x,c,k,null,!0):B(g,c,k,null,!1)}}break;default:if(k=Ba(e,!0),!yb(D(e),k,qa(e),Ua(e))||k!=m.String&&k!=m.Numeric||!h(e.getAttribute("ce207")))32==b?ib(Aa(e)):La(b)&&(y=g+=String.fromCharCode(b),ib(Aa(e)))}break;case d.LeftParenthesis:case d.LeftSource:32==b?B(Ja(),c,Ka,d.LeftParenthesis):
La(b)&&(y=g+=String.fromCharCode(b),ya(Ja(),c,Ka,d.LeftParenthesis),Za=!0);break;case d.RightSource:Z(c);32==b?B(sa(),c,oa,d.RightParenthesis):La(b)&&(y=g+=String.fromCharCode(b),ya(sa(),c,oa,d.RightParenthesis));break;case d.RightParenthesis:case d.RightBracket:32==b?B(sa(),c,oa,d.RightParenthesis):La(b)&&(y=g+=String.fromCharCode(b),ya(sa(),c,oa,d.RightParenthesis));break;case d.Exists:32==b?B(Nc(mb(c,d.Field).getAttribute("ce208")),c,Oc,null):La(b)&&(y=g+=String.fromCharCode(b),ya(Nc(mb(c,d.Field).getAttribute("ce208")),
c,Oc,null));break;case d.Field:if(32==b&&$a(e)){g=h(e.nextSibling)?ic(e.nextSibling):null;g&&D(g)==d.Setter&&"to"==g.getAttribute("ce208")||(g=G(z.fds,e.getAttribute("ce208")),h(g)&&(ba({t:d.Setter,id:null,v:"to",n:Ib(q.els.str,"to"),st:g.o,ct:r.None,ft:n.None,it:u.None,h:!1,fv:!1}),ra()&&fb(xa(e))));break}k=G(z.fds,e.getAttribute("ce208"));k.ct!=H.Reference&&(k=sb(k),32==b?B(k,c,nb,null):La(b)&&(y=g+=String.fromCharCode(b),ya(k,c,nb,null)));break;case d.Operator:32==b?"isNull"==e.getAttribute("ce208")||
"isNotNull"==e.getAttribute("ce208")?B(sa(),e,oa,d.RightParenthesis):fb(e):La(b)&&(y=g+=String.fromCharCode(b),"isNull"==e.getAttribute("ce208")||"isNotNull"==e.getAttribute("ce208")?ya(sa(),c,oa,d.RightParenthesis):h(F)&&0<F.length?ya(F,c,Qc,null):h(P.ce)&&0<P.ce.length||0<P.length?ya(P,c,Eb?qd:rd,null):fb(e));break;case d.Clause:32==b?"then"==e.getAttribute("ce208")||$a(e)?B(db(),c,eb,null):B(Ja(),c,Ka,d.LeftParenthesis):La(b)&&(k="then"==e.getAttribute("ce208")||$a(e),y=g+=String.fromCharCode(b),
ya(k?db():Ja(),c,k?eb:Ka,k?null:d.LeftParenthesis),Za=!0);break;case d.LeftBracket:32==b?B(Va(),c,Ia,null):La(b)&&(y=g+=String.fromCharCode(b),ya(Va(),c,Ia,null));break;case d.Calculation:qa(e)==r.Number?Pc(b)&&!h(e.getAttribute("ce207"))&&(32==b?B(Va(),c,Ia,null):La(b)&&(y=g+=String.fromCharCode(b),ya(Va(),c,Ia,null))):32==b?B(Va(),c,Ia,null):La(b)&&(y=g+=String.fromCharCode(b),ya(Va(),c,Ia,null));break;case d.Setter:32==b?"set"==e.getAttribute("ce208")?B(Mb(),c,Nb,null):fb(e):La(b)&&(y=g+=String.fromCharCode(b),
"set"==e.getAttribute("ce208")?(ya(Mb(),c,Nb,null),Za=!0):h(F)&&0<F.length?ya(F,c,Qc,null):fb(e));break;case d.Value:if(Pc(b))if(k=Ba(e),k==m.String||k==m.Numeric)h(e.getAttribute("ce207"))||(32==b?B(sa(),c,oa,d.RightParenthesis):La(b)&&(y=g+=String.fromCharCode(b),ya(sa(),c,oa,d.RightParenthesis)));else if(k==m.Numeric&&32==b)h(e.getAttribute("ce207"))||B(sa(),c,oa,d.RightParenthesis);else if(k==m.Date||k==m.Time||k==m.Bool||k==m.Enum)32==b?B(sa(),c,oa,d.RightParenthesis):La(b)&&(y=g+=String.fromCharCode(b),
ya(sa(),c,oa,d.RightParenthesis))}}}if(ac)return 8!=b&&9!=b&&32!=b&&33!=b&&34!=b&&35!=b&&36!=b&&38!=b&&40!=b||a.preventDefault(),!1;32==b?(a.preventDefault&&!h(e.getAttribute("ce207"))&&a.preventDefault(),a.stopPropagation&&a.stopPropagation()):(8==b||9==b)&&a.stopPropagation&&a.stopPropagation()},Fc=function(a){if(9==w)return!1;if(1==w||2==w)return!0;a=a.keyCode;if(16==a)return!1;if(8!=w){46==a&&h(c.nextSibling)&&(c=ic(c.nextSibling));var b=D(c);var g=Ba(c,!0)}switch(a){case 27:y="";if(8==w){Ta();
break}6==w?Ta():3==w?(Ab(),w=0):4==w&&(zb(),w=0);"INPUT"==c.tagName&&(Oa(),c=I(c),va());break;case 127:y="";if(8==w){Ta();break}6==w&&Ta();3==w?(Ab(),w=0):4==w?(zb(),w=0):yb(b,g,qa(c),Ua(c))&&h(c.getAttribute("ce207"))||(h(c.nextSibling)?D(c.nextSibling)==d.HtmlTag?mc():b==d.NewLine?(Ea(c),Ea(c),h(c.nextSibling)&&(h(c.nextSibling)&&D(c.nextSibling)==d.Tab&&mc(),c=I(h(c.nextSibling)?c.nextSibling:c),Z(c))):ab(c)?(c=c.nextSibling,pb()):(pb(),h(c.nextSibling)&&(D(c.nextSibling)==d.HtmlTag&&mc(),c=I(h(c.nextSibling)?
c.nextSibling:c),Z(c))):b==d.NewLine?(Ea(c),Ea(c)):ab(c)||pb(),Pa(c)&&hb(c));break;case 8:y="",8==w?Ta():(6==w&&Ta(),3==w?(Ab(),w=0):4==w?(zb(),w=0):(yb(b,g,qa(c),Ua(c))||(b==d.RightSource?pb():!h(c.previousSibling)||ab(c)||ab(c.previousSibling)||(D(c)==d.NewLine||D(c.previousSibling)==d.NewLine?(c=xa(c.previousSibling),mc(),c=I(h(c.nextSibling)?c.nextSibling:c),Z(c)):ab(c.previousSibling)||(c=c.previousSibling,pb(),c=I(h(c.nextSibling)?c.nextSibling:c),Z(c)))),Pa(c)&&(hb(c),Z(c))))}return!1},Qb=
function(){if(h(C)&&h(C.container)&&h(q))if(9==w)w=1;else{6==w?(ka.close(),w=1):3==w?(Ab(),w=1):4==w?(zb(),w=1):0==w&&(w=1,h(c)&&h(c.getAttribute("ce207"))&&Oa());ld()||sd();2!=w&&q.help&&Jb(q.els.ms.i102);Bc();y="";Za=!1;if(h(c)&&(c.className=$rule.trim(c.className.replace("ceCurrent","")),Pa(c))){var a=Sb(c,n.Name);h(a)&&(a.className=$rule.trim(a.className.replace("ceCurrent","")))}Z(null)}},Ub=function(a){var b=G(a.t==d.Action?z.acs:z.fds,a.m);ba({t:a.t==d.Calculation?a.t:b.t,id:null,v:b.v,n:0<
b.ps.length?b.n+"&nbsp;(":b.n,st:b.t==d.Action?null:b.rt.o,ct:a.t==d.Calculation?r.Function:r.None,ft:n.Name,it:u.None,h:!1,fv:a.v});var g=c;ba({t:a.t==d.Calculation?a.t:b.t,id:null,v:b.v,n:0<b.ps.length?")":"&nbsp;",st:b.t==d.Action?null:b.rt.o,ct:a.t==d.Calculation?r.Function:r.None,ft:n.End,it:u.None,h:!1,fv:a.v});0<b.ps.length?(c=I(g),ra()&&ib(b)):ra()&&Tb(b)},ib=function(a){var b=lb(c);if(b>=a.ps.length-1&&!Y){var g=Gc(c,n.End);h(g)&&(c=I(g),Tb(a))}else switch(b+=1,Y&&--b,g=a.ps[b],a=[],F=null,
g.ai){case Q.All:case Q.Fields:if(g.o==m.Collection){for(var e=0;e<z.fds.length;e++){var k=z.fds[e];Da&&c.getAttribute("ce208")==k.v||k.t==d.Field&&k.o==m.Collection&&(g.ct==H.Generic?k.cg&&a.push(k):k.ct==g.ct&&k.cr==g.cr&&k.cg==g.cg&&k.cv==g.cv&&k.cl==g.cl&&a.push(k))}0<y.length?ya(a,c,ob,null):B(a,c,ob,null)}else{a:{e=g.o;var x=b;b=[];var v=Ya(c);if(h(v)){k=G(z.fds,v.getAttribute("ce208"));h(k)||(k=G(z.acs,v.getAttribute("ce208")));if(!h(k)){e=b;break a}k=k.ps[x]}if(h(k)){v=h(k.ftr)?k.ftr:null;
for(var t=0,A;t<z.fds.length;t++)if(x=z.fds[t],x.t==d.Field&&!x.ir&&x.o==e){if(k.o==m.Numeric){if(k.l!=x.l||x.min<k.min||x.max>k.max||x.dec&&!k.dec||x.mds!=k.mds)continue}else if(k.o==m.Enum){if(k.e!=x.e||k.l!=x.l)continue}else if(k.l!=x.l)continue;A=h(x.ftr)?x.ftr:null;null!=v&&"any"!=v&&v!=A&&"any"!=A||b.push(x)}}e=b}if(0<e.length){g.ai==Q.All&&V("ce801",h(g.mds)?g.mds:g.o,qb(g.o,h(g.mds)),a);g=[];for(b=0;b<e.length;b++)k=e[b],Da&&c.getAttribute("ce208")==k.v||g.push(k);if(0<g.length)for(e=0;e<
g.length;e++)a.push(g[e]);0<y.length?ya(a,c,ob,null):B(a,c,ob,null)}else h(g.mds)?Rc(g.mds,g.ftr):ob("ce801",g.o)}break;case Q.User:h(g.mds)?Rc(g.mds,g.ftr):ob("ce801",g.o);break;default:throw Error("CL58");}},Rc=function(a,b){F=xb(a,b);var g=[];if(null!=F&&0<F.length){for(var e=0;e<F.length;e++)V(F[e].ID,a,F[e].Name,g);0<y.length?ya(g,c,ob,null):B(g,c,ob,null)}else ob("ce801",m.Numeric)},ob=function(a,b,g){function e(v,t){if(Y){var A=c;Y=!1}else A=U(c)==n.Name?c:c.nextSibling;A=Ob(A,t);h(A)?Ea(A):
Sc(v)}function k(v){var t=null,A=v?m.Date:m.Time;v=v?"":"1/1/2000 ";try{var E=c;if(U(E)!=n.Param||Ba(E)!=A)E=Ob(E,A);h(E)&&(t=new Date(v+E.getAttribute("ce206")));isNaN(t.getDate())&&(t=null);return t}catch(O){return null}}var x=Aa(c);if("ce801"==a)if(a=td(b),h(a))ea=Y,b=null,0<x.ps.length&&(b=lb(c),0>b&&(b=0),b=x.ps[b].ftr),Rc(a.Name,b);else switch(parseInt(b,10)){case m.Numeric:ea=!1;nc(Ob(h(c.nextSibling)?c.nextSibling:c,m.Numeric))&&(b=lb(c),b++,e(x,m.Numeric),cb({t:x.t,v:"",st:m.Numeric,ct:r.None,
ft:n.Param,pi:b,span:c}));break;case m.String:ea=!1;nc(Ob(h(c.nextSibling)?c.nextSibling:c,m.String))&&(b=lb(c),b++,e(x,m.String),cb({t:x.t,v:"",st:m.String,ct:r.None,ft:n.Param,pi:b,span:c}));break;case m.Date:ka.close();w=3;Ca.show(c,Xd,Tc(x,Ca.defaultFormat()),Y,k(!0));Ca.position();break;case m.Time:ka.close();w=4;ja.show(c,Yd,Tc(x,ja.defaultFormat()),Y,k(!1));ja.position();break;case m.Enum:a=lb(c)+(Y?0:1);0>a&&(a=0);a<=x.ps.length-1&&(F=Hb(x.ps[a].e),ea=Y);B(F,c,Zd,null);break;case m.Bool:ea=
Y;B(ud(),c,$d,null);break;case m.Collection:break;default:throw Error("CL62");}else"ce804"==a||"ce805"==a?(Ga="ce805"==a?"ce805":g,Y=!0,B(Ja(),c,ob,null)):(b=xb(b),h(b)?(e(x,m.Numeric),ba({t:x.t,id:null,v:a,n:G(b,a).Name,st:m.Numeric,ct:r.None,ft:n.Param,it:u.Field,h:!1,fv:!1})):(a=G(z.fds,a),e(x,a.o),ba({t:x.t,id:null,v:a.v,n:a.n,st:a.o,ct:r.None,ft:n.Param,it:u.Field,h:!1,fv:!1})),F=null,c=I(c),ra()&&ib(x))},$d=function(a){vd(a,m.Bool,Zb(a))},Zd=function(a){vd(a,m.Enum,G(F,a).Name)},vd=function(a,
b,g){var e=Ob(Y?c:c.nextSibling,b),k=!1;h(e)&&(ka.close(),Ea(e),k=!0,Y=!1);e=Aa(c);k||Sc(e);ba({t:e.t,id:null,v:a,n:g,st:b,ct:r.None,ft:n.Param,it:u.Input,h:!1,fv:!1});c.setAttribute("ce206",a);c=I(c);ra()&&ib(e)},Xd=function(a){var b=Aa(c);wd(a,b,m.Date,p.formatDate(new Date(a),Tc(b,Ca.defaultFormat())),Ca)},Yd=function(a,b){wd(a,Aa(c),m.Time,b,ja)},wd=function(a,b,g,e,k){var x=Ob(Y?c:c.nextSibling,g),v=!1;h(x)&&(Ea(x),v=!0,Y=!1);ba({t:b.t,id:null,v:a,n:e,st:g,ct:r.None,ft:n.Param,it:u.Input,h:!1,
fv:!1});c=I(c);k.hide();w=0;if(!v)switch(a=Wa(c.nextSibling),U(a)){case n.Param:a=c;ba({t:b.t,id:null,v:"",n:",",st:b.t==d.Action?null:b.rt.o,ct:r.None,ft:n.Comma,it:u.None,h:!1,fv:!1});c=I(a);break;case n.End:case n.Comma:a=c,g=xa(c.previousSibling),U(g)==n.Param&&1<Aa(c).ps.length&&(c=g,ba({t:b.t,id:null,v:"",n:",",st:b.t==d.Action?null:b.rt.o,ct:r.None,ft:n.Comma,it:u.None,h:!1,fv:!1}),c=I(a))}ea=!1;va();ra()&&ib(b)},Sc=function(a){var b=Wa(c.nextSibling);switch(U(b)){case n.Comma:c=b;Sc(a);break;
case n.Param:ba({t:a.t,id:null,v:"",n:",",st:a.t==d.Action?null:a.rt.o,ct:r.None,ft:n.Comma,it:u.None,h:!1,fv:!1});c=I(c.previousSibling);break;case n.End:b=U(c)!=n.None?null:c;var g=xa(c);U(g)==n.Param&&1<Aa(c).ps.length&&(c=I(g),ba({t:a.t,id:null,v:"",n:",",st:a.t==d.Action?null:a.rt.o,ct:r.None,ft:n.Comma,it:u.None,h:!1,fv:!1}),h(b)&&(c=I(b)))}},lb=function(a){for(var b=-1;h(a)&&U(a)!=n.Name;)U(a)==n.Param&&b++,a=a.previousSibling;return b},Tb=function(a){if(h(a)&&ra())if(D(c)==d.Calculation&&
U(c)==n.End)B(Va(),c,Ia,null);else if(a.t==d.Function){var b=Sb(c,n.Name);h(b)?"true"==b.getAttribute("ce216")?B(sa(),c,oa,d.RightParenthesis):B(sb(a),c,nb,null):B(sb(a),c,nb,null)}else a=fc(),0<a.length&&B(a,c,gc,null)},Aa=function(a){a=Sb(a,n.Name);return h(a)?G(D(a)==d.Action?z.acs:z.fds,a.getAttribute("ce208")):null},cd=function(a,b){for(var g=0,e,k;g<a.length;g++)if(e=a[g],!h(e.Client)||!e.Client){k=new p.StringBuilder;b?h(e.Ns)&&0<e.Ns.length&&(CodeEffects.register(e.Ns),k.append(e.Ns),k.append(".")):
k.append("CodeEffects.Rule.");k.append(xd(e.Name));h(eval(k.dump()))?k.append(".ce = ["):k.append(" = [");if(!h(e.Data)||!e.Data.length||null==e.Data[0])throw Error("Enum or menu data source is empty (CL39)");for(var x=0,v;x<e.Data.length;x++)v=e.Data[x],0<x&&k.append(","),k.append('{"ID":"'),k.append(v.ID),k.append('","Name":"'),k.append(v.Name),h(v.Filter)&&(k.append('","Filter":"'),k.append(v.Filter)),k.append('"}');k.append("]");eval(k.dump())}},Pc=function(a){switch(a){case 8:case 9:case 16:case 17:case 18:case 19:case 20:case 27:case 127:return!1;
default:return!0}},B=function(a,b,g,e,k){h(a.ce)&&(a=a.ce);ka.close();var x=[];if(h(e)){a:{var v=!0;D(c)!=d.RightSource||h(c.nextSibling)||(v=!1);var t=mb(h(c.nextSibling)?c.nextSibling:c,d.RightSource);h(t)?v&&(t=t.previousSibling):(t=mb(c,d.Flow),h(t)?t=t.previousSibling:(t=bb(),t=t[t.length-1]));var A=0;v=0;for(var E;h(t);){E=D(t);if(E==d.RightSource){t=Uc(t,d.LeftSource);if(h(t)&&h(t.previousSibling))t=t.previousSibling;else{v=t=0;break a}E=D(t)}if(E==d.Flow||E==d.LeftSource)break;E==d.LeftParenthesis&&
A++;E==d.RightParenthesis&&v++;t=h(t.previousSibling)&&D(t.previousSibling)!=d.Flow?t.previousSibling:null}t=A}if(e==d.RightParenthesis&&t>v){if(e=new p.Menu.Item,e.Name=q.els.lbl.pe,e.Type=d.RightParenthesis,x.push(e),a[0].t==d.Clause){e=[];for(t=0;t<a.length;t++)"then"!=a[t].v&&e.push(a[t]);a=e}}else e==d.LeftParenthesis&&(e=new p.Menu.Item,e.Name=q.els.lbl.pb,e.Type=d.LeftParenthesis,x.push(e))}for(t=0;t<a.length;t++){v=a[t];e=new p.Menu.Item;e.ID=v.v||v.ID;e.Name=v.n||v.Name;if(h(v.t)||h(v.Type))e.Type=
v.t||v.Type;x.push(e)}ka.fill(b,x,g,ae,q.help?be:null);ea&&ka.alignLeft(b);ea=!1;w=6;k||(y="")},ya=function(a,b,g,e){a=pd(a,y);if(0<a.length){var k=y;B(a,b,g,e,!0);ka.select(k)}else Ta()},fb=function(a,b){function g(L,Ha){if("ce801"==L)switch(parseInt(Ha,10)){case m.Numeric:cb({t:d.Value,v:"",st:m.Numeric,ct:r.None,ft:n.None,span:c});break;default:$b(xa(a))}else if("C"==L)Kc(L);else{var ha=G(z.fds,L);ha.t==d.Function?Ub({t:ha.t,m:L,v:!0}):kd(ha,L,!1)}}function e(L){if("ce801"==L){L=x();var Ha=null;
L.t==d.Function?h(L.rt.mds)&&(Ha=L.rt.mds):h(L.mds)&&(Ha=L.mds);k(Ha,L.ftr)}else g(L)}function k(L,Ha){F=xb(L,Ha);null!=F&&(ea=Y,B(F,c,Qc,null))}function x(){var L=Ya(c);return h(L)?G(z.fds,L.getAttribute("ce208")):null}function v(L,Ha,ha,wa){for(var na=0;na<L.length;na++){var ca=L[na];ca.t!=d.Function&&ca.v==ha.v||V(ca.v,ca.o,ca.n,Ha)}0<y.length?ya(Ha,c,wa,null):B(Ha,c,wa,null)}var t=x();if(h(t)){var A=t.t==d.Function?t.rt.ai:t.ai,E=yd(t),O=null;t.t==d.Function?h(t.rt.mds)&&(O=t.rt.mds):h(t.mds)&&
(O=t.mds);if(h(O)){var Sa=Vc(E,t);if(A==Q.User||0==Sa.length||1==Sa.length&&Sa[0].v==t.v)k(O,t.ftr);else{var jb=[];0<Sa.length?(A==Q.All&&V("ce801",E,qb(E,!0),jb),v(Sa,jb,t,e)):k(O,t.ftr)}}else A==Q.User?b&&E!=m.Enum&&E!=m.Bool||$b(a):(O=[],Sa=Vc(E,t),0<Sa.length?1==Sa.length&&t.t!=d.Function&&Sa[0].v==t.v?$b(a):((E==m.Numeric&&t.t==d.Function?t.rt.cal:t.cal)&&V("C",E,q.els.lbl.c,O),A==Q.All&&V("ce801",E,qb(E),O),v(Sa,O,t,g)):b||$b(a))}},kd=function(a,b,g){ba({t:g?d.Calculation:d.Value,id:null,v:a.v,
n:a.n,st:a.o,ct:g?r.Field:r.None,ft:n.None,it:u.Field,h:!1,fv:!1});c.setAttribute("ce206",b);ra()&&(g?B(Va(),c,Ia,null):B(sa(),c,oa,d.RightParenthesis))},$b=function(a){function b(g){var e=null;try{var k=c;g=g?"":"1/1/2000 ";D(k)!=d.Value&&(k=mb(k,d.Value));h(k)&&(e=new Date(g+k.getAttribute("ce206")));isNaN(e.getDate())&&(e=null)}catch(x){e=null}return e}Ta();switch(Ba(a)){case m.String:nc(c.nextSibling)&&cb({t:d.Value,v:"",st:m.String,ct:r.None,ft:n.None,span:null});break;case m.Date:w=3;a=Ya(c);
a=h(a)?G(z.fds,a.getAttribute("ce208")):null;a=h(a)?h(a.rt)?a.rt.f:a.f:Ca.defaultFormat();Ca.show(c,ce,a,Y,b(!0));Ca.position();break;case m.Time:w=4;a=Ya(c);a=h(a)?G(z.fds,a.getAttribute("ce208")):null;a=h(a)?h(a.rt)?a.rt.f:a.f:ja.defaultFormat();ja.show(c,de,a,Y,b(!1));ja.position();break;case m.Enum:a=Ya(a);h(a)&&(D(a)==d.Function?(a=Aa(a),F=Hb(a.rt.e)):(a=G(z.fds,a.getAttribute("ce208")),F=h(a.e)?Hb(a.e):a.ens),P=F,Eb=!1,ea=Y,B(F,c,rd,null));break;case m.Bool:P=ud();Eb=!0;ea=Y;B(P,c,qd,null);
break;default:a=Ya(c),a=h(a)?G(z.fds,a.getAttribute("ce208")):null,h(a)&&(a.cal||h(a.rt)&&a.rt.cal)?(a=[],V("C",null,q.els.lbl.c,a),V("ce801",null,qb(m.Numeric),a),B(a,c,Kc,null)):nc(c.nextSibling)&&cb({t:d.Value,v:"",st:m.Numeric,ct:r.None,ft:n.None,span:null})}},od=function(){if(6==w||3==w||4==w)return!1;var a=Ya(c);if(!h(a))return!1;a=G(z.fds,a.getAttribute("ce208"));if(a.t==d.Function?a.rt.ai:a.ai!=Q.User){var b=Vc(a.o,a);return 1<b.length&&a.t!=d.Function&&b[0].v!=a.v}return!1},nb=function(a){var b=
xa(c),g=Ba(b,!0);tb(gd(a,g),null);ra()?"isNull"==a||"isNotNull"==a?B(sa(),c,oa,d.RightParenthesis):fb(b):ma=!1},Kc=function(a){switch(a){case "C":ba({t:d.LeftBracket,id:null,v:"",n:q.els.lbl.cb,st:null,ct:r.None,ft:n.None,it:u.None,h:!1,fv:!1});a=c;ba({t:d.RightBracket,id:null,v:"",n:q.els.lbl.ce,st:null,ct:r.None,ft:n.None,it:u.None,h:!1,fv:!1});c=I(a);va();B(Va(),c,Ia,null);break;default:cb({t:d.Value,v:"",st:m.Numeric,ct:r.None,ft:n.None,span:c})}},Ia=function(a,b){if(a==r.Number)a=parseInt(a,
10),cb({t:d.Calculation,v:"",st:m.Numeric,ct:a,ft:n.None,span:Wa(c)}),va();else if(a==r.Function){var g=G(z.fds,b);if(!h(g))throw Error("CL46");Ub({t:d.Calculation,m:b,v:!1})}else{a=parseInt(a,10);g="";switch(a){case r.Field:var e=G(z.fds,b);if(!h(e))throw Error("CL48");g=e.v;e=e.n;break;case r.LeftParenthesis:e=q.els.lbl.pb;break;case r.RightParenthesis:e=q.els.lbl.pe;break;case r.Multiplication:e="&#215;";break;case r.Division:e="&#247;";break;case r.Addition:e="&#43;";break;case r.Subtraction:e=
"&#150;";break;default:throw Error("CL64");}ba({t:d.Calculation,id:null,v:g,n:e,st:null,ct:a,ft:n.None,it:u.None,h:!1,fv:!1});ra()&&B(Va(),c,Ia,null)}},md=function(a){var b=[];V(r.Number,null,qb(m.Numeric),b);a=ec(a);for(var g=0;g<a.length;g++)V(a[g].t==d.Function?r.Function:r.Field,a[g].v,a[g].n,b);Y=ea=!0;B(b,c,Ia,null)},qd=function(a){ba({t:d.Value,id:null,v:a,n:Zb(a),st:m.Bool,ct:null,ft:n.None,it:u.None,h:!1,fv:!1});c.setAttribute("ce206",a);ra()&&B(sa(),c,oa,d.RightParenthesis)},rd=function(a){ba({t:d.Value,
id:null,v:a,n:G(F,a).Name,st:m.Enum,ct:null,ft:n.None,it:u.None,h:!1,fv:!1});F=null;c.setAttribute("ce206",a);ra()&&B(sa(),c,oa,d.RightParenthesis)},Ka=function(a,b,g){if(h(b)&&parseInt(b,10)==d.LeftParenthesis)ba({t:d.LeftParenthesis,id:null,v:"(",n:q.els.lbl.pb,st:null,ct:r.None,ft:n.None,it:u.None,h:!1,fv:!1}),ra()&&B(Ja(),c,Ka,d.LeftParenthesis);else switch(a){case "ce802":case "ce803":Ga=null;b=[];for(g=0;g<z.fds.length;g++){var e=z.fds[g];e.t==d.Field&&e.o==m.Collection&&e.ct==H.Reference&&
b.push(e)}g=[];for(e=0;e<b.length;e++)V(a,b[e].v,b[e].n,g);B(g,c,ee,null);break;case "ce804":Ga=g;B(Ja(),c,Ka,null);Za&&(Ga=g);break;case "ce805":Ga="ce805";B(Ja(),c,Ka,null);Za&&(Ga="ce805");break;default:Ga=null,b=G(z.fds,a),b.t==d.Function?Ub({t:b.t,m:a,v:!1}):(tb(b,null),ra()&&B(sb(b),c,nb,null))}},Qc=function(a){ba({t:d.Value,id:null,v:a,n:G(F,a).Name,st:m.Numeric,ct:r.None,ft:n.None,it:u.Field,h:!1,fv:!1});F=null;c.setAttribute("ce206",a);ra()&&B(sa(),c,oa,d.RightParenthesis)},ee=function(a,
b){var g=G(z.fds,b);ba({t:d.Exists,id:null,v:a,n:Dc(a),st:null,ct:null,ft:n.None,it:u.None,h:!1,fv:!1});tb(g,null);ba({t:d.Where,id:null,v:a,n:Ib(q.els.dsc,"where"),st:null,ct:null,ft:n.None,it:u.None,h:!1,fv:!1});ba({t:d.LeftSource,id:null,v:g.cv,n:q.els.lbl.ub,st:null,ct:r.None,ft:n.None,it:u.None,h:!1,fv:!1});g=c;ba({t:d.RightSource,id:null,v:z.n,n:q.els.lbl.ue,st:null,ct:r.None,ft:n.None,it:u.None,h:!1,fv:!1});c=I(g);Z(c);B(Ja(),c,Ka,d.LeftParenthesis)},Oc=function(a){Y=!0;a=G(z.fds,a);var b=
mb(c,d.Field);c=I(b);tb(a,null)},Vd=function(a){Y=!0;ba({t:d.Exists,id:null,v:a,n:Dc(a),st:null,ct:null,ft:n.None,it:u.None,h:!1,fv:!1})},Nb=function(a,b,g){switch(a){case "ce804":Ga=g;B(Mb(),c,Nb,null);Za&&(Ga=g);break;case "ce805":Ga="ce805";B(Mb(),c,Nb,null);Za&&(Ga="ce805");break;default:a=G(z.fds,a),tb(a,null),ba({t:d.Setter,id:null,v:"to",n:Ib(q.els.str,"to"),st:a.o,ct:null,ft:n.None,it:u.None,h:!1,fv:!1}),ra()?fb(xa(c)):ma=!1}},oa=function(a,b){"else"==a||"elseIf"==a?gc(a):h(b)&&parseInt(b,
10)==d.RightParenthesis?(ba({t:d.RightParenthesis,id:null,v:")",n:q.els.lbl.pe,st:null,ct:r.None,ft:n.None,it:u.None,h:!1,fv:!1}),ra()&&B(sa(),c,oa,d.RightParenthesis)):(tb(G(q.els.cls,a),null),("then"==a||$a(c))&&ra()?B(db(),c,eb,null):ra()&&B(Ja(),c,Ka,d.LeftParenthesis))},ce=function(a){var b=Ya(c);b=h(b)?G(z.fds,b.getAttribute("ce208")):null;b=h(b)?h(b.rt)?b.rt.f:b.f:Ca.defaultFormat();var g=!0,e=Wa(c);h(e)&&D(e)==d.Value&&Ba(e)==m.Date&&(c=I(e),g=!1);g?ba({t:d.Value,id:null,v:a,n:p.formatDate(new Date(a),
b),st:m.Date,ct:null,ft:n.None,it:u.None,h:!1,fv:!1}):(c.setAttribute("ce206",a),p.text(c,p.formatDate(new Date(a),b)));Ca.hide();ea=!1;w=0;va();ra()&&B(sa(),c,oa,d.RightParenthesis)},de=function(a,b){var g=!0;if(h(c.nextSibling)){var e=Wa(c.nextSibling);h(e)&&D(e)==d.Value&&Ba(e)==m.Time&&(c=I(e),g=!1)}g?ba({t:d.Value,id:null,v:a,n:b,st:m.Time,ct:null,ft:n.None,it:u.None,h:!1,fv:!1}):(c.setAttribute("ce206",a),p.text(c,b));ja.hide();ea=!1;w=0;va();ra()&&B(sa(),c,oa,d.RightParenthesis)},eb=function(a){"set"==
a?(ba({t:d.Setter,id:null,v:"set",n:Ib(q.els.str,"set"),st:null,ct:null,ft:n.None,it:u.None,h:!1,fv:!1}),ra()?B(Mb(),c,Nb,null):ma=!1):Ub({t:G(z.acs,a).t,m:a,v:!1})},gc=function(a){var b="and"==a;tb(G(b?q.els.cls:q.els.fls,a),null);ra()&&(b?B(db(),c,eb,null):"else"==a?B(db(),c,eb,null):B(Ja(),c,Ka,d.LeftParenthesis))},ba=function(a){var b=new p.Client.Element;b.n=a.n;b.v=a.v;b.t=a.t;b.o=h(a.st)?a.st:m.None;b.CalType=h(a.ct)?a.ct:r.None;b.FuncType=h(a.ft)?a.ft:n.None;b.q=a.fv;b.InpType=h(a.it)?a.it:
u.None;tb(b,a.id,a.h)},tb=function(a,b,g){var e=!(!h(c)||!h(c.nextSibling));var k=document.createElement("SPAN");k.id=h(b)?b:C.container.id+Xa;Xa++;99999999999<Xa&&(Xa=0);k.setAttribute("ce218","false");a.t==d.Field&&a.o==m.Collection?(b=G(z.fds,a.v),b.ct==H.Reference?h(b.cn)?k.innerHTML=b.cn:k.innerHTML=a.n:k.innerHTML=a.n):k.innerHTML=a.n;a.t==d.Value?(za(k,"ceValue"),k.setAttribute("ce206",a.v)):a.t==d.Calculation?(a.CalType==r.Function?a.FuncType==n.Name||a.FuncType==n.End?za(k,"ceMethod"):a.FuncType==
n.Param?a.InpType==u.Field?za(k,"ceFieldInput"):za(k,"ceValue"):za(k,"ceValue"):a.CalType==r.RightParenthesis?(k.onmouseover=function(x){oc(this,zd)},k.onmouseout=function(x){pc(this,zd)},za(k,"ceParenthesis"),k.style.paddingRight=k.style.paddingLeft="2px"):a.CalType==r.LeftParenthesis?(k.onmouseover=function(x){oc(this,Ad)},k.onmouseout=function(x){pc(this,Ad)},za(k,"ceParenthesis"),k.style.paddingRight=k.style.paddingLeft="2px"):za(k,"ceValue"),h(a.v)&&k.setAttribute("ce206",a.v)):a.t==d.Flow?za(k,
"ceFlow"):a.t==d.Field?za(k,"ceField"):a.t==d.Function?a.FuncType==n.Name||a.FuncType==n.End?(k.setAttribute("ce216",a.q?"true":"false"),za(k,"ceMethod")):(a.FuncType==n.Param?a.InpType==u.Field?za(k,"ceFieldInput"):za(k,"ceValue"):za(k,"ceValue"),a.InpType==u.Input&&h(a.v)&&k.setAttribute("ce206",a.v)):a.t==d.Action?a.FuncType==n.Name||a.FuncType==n.End?za(k,"ceAction"):(a.FuncType==n.Param?a.InpType==u.Field?za(k,"ceFieldInput"):za(k,"ceValue"):za(k,"ceValue"),a.InpType==u.Input&&h(a.v)&&k.setAttribute("ce206",
a.v)):a.t==d.Operator?za(k,"ceOperator"):a.t==d.LeftBracket||a.t==d.RightBracket?za(k,"ceParenthesis"):a.t==d.LeftSource||a.t==d.RightSource?za(k,"ceBrace"):a.t==d.Clause||a.t==d.Setter||a.t==d.Where||a.t==d.Exists?za(k,"ceClause"):a.t==d.Tab?za(k,"ceTab"):a.t==d.NewLine&&za(k,"ceNewLine");a.t==d.Tab?k.style.paddingRight=k.style.paddingLeft="8px":a.t!=d.Function&&a.t!=d.Action&&a.t!=d.Calculation||a.FuncType!=n.End?(a.t==d.RightParenthesis?(k.onmouseover=function(x){oc(this,Bd)},k.onmouseout=function(x){pc(this,
Bd)},k.className="ceParenthesis"):a.t==d.LeftParenthesis&&(k.onmouseover=function(x){oc(this,Cd)},k.onmouseout=function(x){pc(this,Cd)},k.className="ceParenthesis"),k.style.paddingRight=k.style.paddingLeft="2px"):(b=G(a.t==d.Action?z.acs:z.fds,a.v),h(b)&&h(b.ps)&&0!=b.ps.length||(k.style.paddingRight=k.style.paddingLeft="0",k.style.width="2px"));k.style.paddingBottom="2px";k.style.display="inline-block";k.style.whiteSpace="nowrap";k.setAttribute("ce202",a.t);a.t==d.Field&&a.o==m.Bool&&(a.ir?k.setAttribute("ce213",
"true"):(b=G(z.fds,a.v),h(b)&&h(b.ir)&&b.ir&&k.setAttribute("ce213","true")));k.setAttribute("ce203",h(a.CalType)?a.CalType:r.None);k.setAttribute("ce204",h(a.FuncType)?a.FuncType:n.None);k.setAttribute("ce205",h(a.InpType)?a.InpType:u.None);k.setAttribute("ce208",a.v);h(a.o)&&a.o!=m.None?k.setAttribute("ce209",a.o):k.setAttribute("ce209",m.None);Y&&pb();Y=!1;if(e){if(e=c.nextSibling,C.container.insertBefore(k,c.nextSibling),a.t!=d.Tab){if(h(e)&&D(e)==d.Tab)for(;h(e)&&D(e)==d.Tab;)b=e.nextSibling,
C.container.removeChild(e),e=b;if(h(e)){if(a.t==d.RightBracket&&D(e)==d.LeftBracket){for(;D(e)!=d.RightBracket;)b=e.nextSibling,C.container.removeChild(e),e=b;C.container.removeChild(e)}a.t!=d.Calculation||a.CalType!=r.Field&&a.CalType!=r.Number?(a.t==d.Value||a.t==d.Operator&&"isNull"!=a.v&&"isNotNull"!=a.v||a.t==d.Clause&&"then"==a.v||a.t==d.Flow&&"else"==a.v)&&a.t==D(e)&&a.o==Ba(e)&&C.container.removeChild(e):a.t==D(e)&&fe(a.CalType,qa(e))&&C.container.removeChild(e)}}}else C.container.appendChild(k);
a.t!=d.Function&&a.t!=d.Action&&a.t!=d.Calculation||a.FuncType!=n.End||!Pa(k)?c=g?k:I(k):hb(k,g);q.titles&&ge(a);Da=!1;va()},cb=function(a){Ta();var b=xa(h(a.span)?a.span:c),g=document.createElement("INPUT");g.type="text";g.id=C.container.id+Xa;Xa++;99999999999<Xa&&(Xa=0);g.className="ceValue";g.style.marginRight=g.style.marginLeft="2px";g.style.width="2px";var e=Ya(b);b=null;h(e)&&(b=G(z.fds,e.getAttribute("ce208")),h(b)||(b=G(z.acs,e.getAttribute("ce208"))));if(h(b)){e=-9007199254740992;var k=null,
x=null;b.t==d.Function||b.t==d.Action?a.ft==n.Param?h(a.pi)&&h(b.ps[a.pi])&&(e=h(b.ps[a.pi].min)?b.ps[a.pi].min:e,h(b.ps[a.pi].max)&&(k=b.ps[a.pi].max),x=h(b.ps[a.pi].dec)?b.ps[a.pi].dec:!0):(e=h(b.rt.min)?b.rt.min:e,h(b.rt.max)&&(k=b.rt.max),x=h(b.rt.dec)?b.rt.dec:!0):(e=h(b.min)?b.min:e,h(b.max)&&(k=b.max),x=h(b.dec)?b.dec:!0);a.st==m.Numeric?(g.maxLength=28,g.setAttribute("ce212",h(k)?k.toString():(-1*e).toString()),g.setAttribute("ce211",e.toString()),g.setAttribute("ce214",x?"1":"0"),g.setAttribute("ce215",
0>e?"1":"0")):(g.maxLength=h(k)?k:256,g.setAttribute("ce212",g.maxLength.toString()))}else g.maxLength=256,g.setAttribute("ce212",g.maxLength.toString());h(a.span)?D(a.span)==d.Value||D(a.span)==d.Calculation&&qa(a.span)==r.Number||(D(a.span)==d.Function||D(a.span)==d.Action)&&Ua(a.span)==u.Input?(ub=a.span.id,a.span.style.display="none",C.container.insertBefore(g,a.span)):(ub=null,h(a.span.nextSibling)?C.container.insertBefore(g,a.span.nextSibling):C.container.appendChild(g)):h(c)&&h(c.nextSibling)?
C.container.insertBefore(g,c.nextSibling):(ub=null,C.container.appendChild(g));g.setAttribute("ce202",a.t);g.setAttribute("ce209",h(a.st)?a.st:m.None);g.setAttribute("ce206",a.v);g.setAttribute("ce203",h(a.ct)?a.ct:r.None);g.setAttribute("ce204",h(a.ft)?a.ft:n.None);g.setAttribute("ce205",u.Input);g.setAttribute("ce208",a.v);Dd(g);w=0;g.value=h(a.v)?p.decode(a.v):"";0<g.value.length&&Bb(g);if(0==g.value.length)try{g.focus()}catch(v){}else try{g.select()}catch(v){}g.onkeydown=function(v){v=new p.Event(v);
var t=Ba(this);if(t==m.Numeric&&32==v.keyCode)return Rb(q.els.er.e112),v.preventDefault(),!1;if(8==v.keyCode||32==v.keyCode||127==v.keyCode||37==v.keyCode||39==v.keyCode)return!0;if(t==m.Numeric){t=v.keyCode;var A="1"==this.getAttribute("ce214"),E="1"==this.getAttribute("ce215");if(!A&&(188==t||190==t||110==t))return Rb(q.els.er.e110),v.preventDefault(),!1;if(!E&&(109==t||189==t))return Rb(q.els.er.e111),v.preventDefault(),!1;E="";switch(t){case 188:case 190:case 110:var O=188==t?",":".";if(0==this.value.length)return this.value=
"0"+O,Bb(this,v.keyCode),v.preventDefault(),!1;-1<this.value.indexOf(",")||-1<this.value.indexOf(".")?Rb(q.els.er.e113):(this.value+=O,this.value=="-"+O&&(this.value="-0"+O),1<this.value.length&&"0"==this.value.substr(0,1)&&this.value.substr(1,1)!=O&&(this.value=this.value.substr(1)),2<this.value.length&&"-0"==this.value.substr(0,2)&&this.value.substr(2,1)!=O&&(this.value="-"+this.value.substr(2)));v.preventDefault();return!1;case 109:case 189:return 0==this.value.length?(this.value="-",Bb(this,109)):
0>this.value.indexOf("-")&&(this.value="-"+this.value,Bb(this,109)),v.preventDefault(),!1;default:if(O=v.rawEvent.key||v.rawEvent["char"])switch(t){case 48:"0"!=O&&(E=O);break;case 49:"1"!=O&&(E=O);break;case 50:"2"!=O&&(E=O);break;case 51:"3"!=O&&(E=O);break;case 52:"4"!=O&&(E=O);break;case 53:"5"!=O&&(E=O);break;case 54:"6"!=O&&(E=O);break;case 55:"7"!=O&&(E=O);break;case 56:"8"!=O&&(E=O);break;case 57:"9"!=O&&(E=O)}1>E.length&&(96<=t&&105>=t&&(t-=48),E=this.value.replace(",",".")+String.fromCharCode(t),
1<E.length&&"0"==E.substr(0,1)&&"."!=E.substr(1,1)&&(this.value=this.value.substr(1,1),E=E.substr(1,1)),2<E.length&&"-0"==E.substr(0,2)&&"."!=E.substr(2,1)&&(this.value="-"+this.value.substr(2),E="-"+E.substr(2)))}if(A&&!p.isNumeric(E)||!A&&!p.isInteger(E))return Rb(q.els.er.e112),Bb(this),v.preventDefault(),!1}Bb(this,v.keyCode);Ra()};g.onkeyup=function(v){v=new p.Event(v);8!=v.keyCode&&32!=v.keyCode&&127!=v.keyCode||Bb(this);this.setAttribute("ce206",this.value)};g.onpaste=function(v){if(Ba(this)==
m.Numeric)return!1;var t=this;setTimeout(function(){Bb(t)},60)};g.onblur=function(v){Oa()}},Bb=function(a,b){if(!(h(b)&&a.value.length>=a.maxLength)){var g=document.createElement("SPAN");g.id="ceTxt"+C.container.id;g.className="ceValue";g.style.whiteSpace="nowrap";C.container.appendChild(g);g.innerHTML=$rule.encode(a.value+(h(b)?String.fromCharCode(b):""));var e=gb(g).width;C.container.removeChild(g);a.style.width=e+2+"px"}},ge=function(a){function b(e){e=G(z.fds,e);h(e)&&h(e.d)&&(c.title=Yb(e.d))}
switch(a.t){case d.Function:case d.Action:switch(a.FuncType){case n.Name:a=G(a.t==d.Function?z.fds:z.acs,a.v);h(a)&&h(a.d)&&(c.title=Yb(a.d));break;case n.Param:if(a=Aa(c),h(a)&&0<a.ps.length){var g=lb(c);0<=g&&(a=a.ps[g],h(a)&&h(a.d)&&(c.title=Yb(a.d)))}}break;case d.Field:b(a.v);break;case d.Value:a.InpType==u.Field&&b(a.v);break;case d.Calculation:a.CalType==r.Field&&b(a.v)}},pb=function(){D(c)==d.HtmlTag&&(c=I(h(c.nextSibling)?c.nextSibling:c.previousSibling),Z(c));switch(D(c)){case d.Calculation:case d.Function:case d.Action:switch(U(c)){case n.Name:for(;U(c)!=
n.End;){var a=c.nextSibling;C.container.removeChild(c);c=a}Ea(c);break;case n.End:for(;U(c)!=n.Name;)Ea(c);Ea(c);break;case n.Comma:for(Ea(c);U(c)!=n.Name&&U(c)!=n.Comma;)Ea(c);break;case n.Param:a=Wa(c.nextSibling);if(U(a)==n.Comma)c=a,pb();else for(Ea(c);U(c)!=n.Name&&U(c)!=n.Param;)Ea(c);break;default:Ea(c)}break;case d.Field:a=G(z.fds,c.getAttribute("ce208"));h(a)&&a.o==m.Collection&&a.ct==H.Reference?Ed(c):Ea(c);break;case d.LeftBracket:if(!h(c.nextSibling))throw Error("CL82");for(;D(c)!=d.RightBracket;)a=
c.nextSibling,C.container.removeChild(c),c=a;Ea(c);break;case d.RightBracket:if(!h(c.previousSibling))throw Error("CL84");for(;D(c)!=d.LeftBracket;)Ea(c);Ea(c);break;case d.RightSource:case d.LeftSource:case d.Where:case d.Exists:Ed(c);break;default:Ea(c)}va()},Ed=function(a){if(!Y){a=D(c)==d.RightSource?c:Fd(c,d.RightSource);if(!h(a)){Ea(c);return}for(var b=Uc(a,d.Exists).id,g;a.id!=b;)g=a.previousSibling,C.container.removeChild(a),a=g;c=I(a)}Ea(c)},Ea=function(a){if(h(a.previousSibling)){var b=
a.previousSibling;C.container.removeChild(a);c=I(b);Z(c)}},oc=function(a,b){if(!qc(a)){var g=b(a);if(h(g)){if(1==w||a.id!=c.id)a.className+=" ceHighlight";qc(g)||1!=w&&g.id==c.id||(g.className+=" ceHighlight")}}},pc=function(a,b){if(!qc(a)){var g=b(a);if(h(g)){if(1==w||a.id!=c.id)a.className=$rule.trim(a.className.replace("ceHighlight",""));qc(g)||1!=w&&g.id==c.id||(g.className=$rule.trim(g.className.replace("ceHighlight","")))}}},qc=function(a){if(!h(W)||0==W.length)return!1;for(var b=0;b<W.length;b++)if(W[b]==
a.id)return!0;return!1},Bd=function(a){var b=1;a=a.previousSibling;for(var g;h(a);){g=D(a);if(g==d.RightSource)if(a=Uc(a,d.LeftSource),h(a)&&h(a.previousSibling))a=a.previousSibling,g=D(a);else{a=null;break}g==d.RightParenthesis?b++:g==d.LeftParenthesis&&b--;if(0==b)break;else if(g==d.LeftSource||g==d.Flow){a=null;break}else a=a.previousSibling}return h(a)?a:null},Cd=function(a){var b=1;a=a.nextSibling;for(var g;h(a);){g=D(a);if(g==d.LeftSource)if(a=Fd(a,d.RightSource),h(a)&&h(a.nextSibling))a=a.nextSibling,
g=D(a);else{a=null;break}g==d.RightParenthesis?b--:g==d.LeftParenthesis&&b++;if(0==b)break;else if(g==d.RightSource||g==d.Flow){a=null;break}else a=a.nextSibling}return h(a)?a:null},zd=function(a){var b=1;for(a=a.previousSibling;h(a)&&(qa(a)==r.LeftParenthesis?b--:qa(a)==r.RightParenthesis&&b++,0!=b);)a=a.previousSibling;return h(a)&&D(a)!=d.LeftBracket?a:null},Ad=function(a){var b=1;for(a=a.nextSibling;D(a)!=d.RightBracket&&(qa(a)==r.RightParenthesis?b--:qa(a)==r.LeftParenthesis&&b++,0!=b);)a=a.nextSibling;
return h(a)&&D(a)!=d.RightBracket?a:null},Uc=function(a,b){for(var g=0,e=0,k;h(a);){k=D(a);k==d.LeftSource&&g++;if(g==e&&k==b)return a;k==d.RightSource&&e++;a=h(a.previousSibling)&&D(a.previousSibling)!=d.Flow?a.previousSibling:null}return null},Fd=function(a,b){for(var g=0,e=0,k;h(a);){k=D(a);k==d.RightSource&&e++;if(g==e&&k==b)return a;k==d.LeftSource&&g++;a=h(a.nextSibling)&&D(a.nextSibling)!=d.Flow?a.nextSibling:null}return null},wb=function(a,b){if(!h(c.nextSibling)||D(c.nextSibling)!=d.HtmlTag||
!h(c.nextSibling.nextSibling.nextSibling)||D(c.nextSibling.nextSibling.nextSibling)!=d.HtmlTag){var g=document.createElement("BR");g.setAttribute("ce202",d.HtmlTag);h(c)&&h(c.nextSibling)||a?C.container.insertBefore(g,a?c:c.nextSibling):C.container.appendChild(g);c=b?g:I(g);ba({t:d.NewLine,id:null,v:"",n:q.tochki?"&#149;&nbsp;":"&nbsp;&nbsp;",st:null,ct:null,ft:null,fv:!1,it:null,h:b})}},sd=function(){ed();q.help&&Jb(q.els.ms.i101);Na=0;y="";Za=!1;w=2;Z(null)},ad=function(){if(h(C)&&h(C.container)&&
h(q)){6!=w&&8!=w||Ta();sd();if(q.tools){T.setValue("");T.setClass("ceNameBoxDefault");X.setValue("");X.setClass("ceDescriptionBoxDefault");var a=p.getChildrenByAttribute(J,"ce235");0<a.length&&a[0].parentNode.removeChild(a[0])}Fa=null;w=1}},nc=function(a){if(h(a)&&(a=Wa(a),h(a))){var b=Ba(a);if(yb(D(a),b,qa(a),Ua(a))&&Ua(a)!=u.Field)return b!=m.String&&b!=m.Numeric&&Dd(a),c=I(c),Y=ea=!1,va(),!1}return!0},Bc=function(){if(h(W)&&0<W.length){for(var a,b=0;b<W.length;b++)a=document.getElementById(W[b]),
h(a)&&(a.className=$rule.trim(a.className.replace("ceHighlight","")),a.title="");W=[]}q.help&&(M.className=$rule.trim(M.className.replace("ceError","")))},hc=function(){ia=null;for(var a=p.getChildrenByAttribute(C.container,"ce218","true"),b,g=0;g<a.length;g++)b=a[g],b.className=p.trim(b.className.replace("ceSelected","")),b.setAttribute("ce218","false")},nd=function(a,b){S=[];sibling=null;var g=p.getChildrenByAttribute(C.container,"ce218","true");if(0<g.length){for(var e=!1,k=!1,x=0,v,t;x<g.length;x++){v=
g[x];t=D(v);f=U(v);switch(t){case d.HtmlTag:e=!0;break;case d.NewLine:case d.Tab:if(!e)continue;break;default:e=!1}switch(t){case d.Function:case d.Action:if(f==n.Name)k=!0;else if(!k)continue;break;case d.Calculation:if(f==n.Name)k=!0;else if(f==n.None||k)k=!1;else continue;break;default:k=!1}a&&h(v.previousSibling)&&(sibling=v.previousSibling,t=D(sibling),t==d.HtmlTag||t==d.NewLine)&&(sibling=sibling.previousSibling);t=a?C.container.removeChild(v):v.cloneNode(!0);t.className=p.trim(v.className.replace("ceSelected",
""));t.setAttribute("ce218","false");S.push(t)}a&&h(sibling)&&(c=I(sibling));Ra(b,g.length)}},Id=function(a){a="ceT"+C.container.id;J=document.getElementById(a);h(J)&&J.parentNode.removeChild(J);J=document.createElement("DIV");J.id=a;J.className="ceToolBar";a=document.createElement("DIV");a.className="ceContainer";J.appendChild(a);var b=document.createElement("DIV");b.className="ceRulesMenu";a.appendChild(b);Qa=document.createElement("SPAN");Qa.id="ceRl"+C.container.id;Qa.className="ceRulesButton";
Qa.innerHTML=q.els.lbl.r+"&nbsp;&#9662;";b.appendChild(Qa);Qa.onclick=function(e){Z(null);(new p.Event(e)).stopPropagation();Qb();ea=!0;0<y.length?ya(aa,Qa,lc,null):B(aa,Qa,lc,null);w=8};b=document.createElement("DIV");b.className="ceControls";b.setAttribute("ce234","true");a.appendChild(b);var g=document.createElement("DIV");g.className="ceInputName";b.appendChild(g);T=new p.TextBox.Control;T.init(new p.TextBox.Settings(g,"ceTl"+C.container.id,"ceNameBox","ceNameBoxDefault",50,q.els.lbl.n,q.els.er.e104,
"ceError"));g=document.createElement("DIV");g.className="ceInputDesc";b.appendChild(g);X=new p.TextBox.Control;X.init(new p.TextBox.Settings(g,"ceTd"+C.container.id,"ceDescriptionBox","ceDescriptionBoxDefault",80,q.els.lbl.d,q.els.er.e104,"ceError"));g=document.createElement("DIV");g.className="ceSave";b.appendChild(g);b=document.createElement("SPAN");b.className="ceSaveButton";b.innerHTML=q.els.lbl.a;g.appendChild(b);b.onclick=function(e){6!=w&&8!=w||Ta();e=bb();0!=e.length&&(1!=e.length||h(D(e[0]))&&
D(e[0])!=d.Flow)?Wc("ceSave"):alert(q.els.er.e106)};J.appendChild(a);C.container.appendChild(J)},dd=function(){var a=document.getElementById("ceH"+C.container.id);h(a)&&a.parentNode.removeChild(a);M=null;q.help=!1},Wc=function(a){Gb=a;Z(null);if(C.clientOnly)switch(Gb){case "ceDelete":if(!h(Fa))throw Error("CL31");if(!h(xc)){alert("The Delete action is not defined");break}vb=!0;xc(Fa);break;case "ceSave":if(!h(wc)){alert("The Save action is not defined");break}vb=!1;wc(Fb.serialize(cc()));break;default:h(yc)?
(vb=!0,yc(a)):alert("The Load action is not defined")}else if(C.asp){vb="ceSave"!=Gb;try{eval(q.pb+"('"+C.id+"','')")}catch(g){alert("Unexpected order of elements (CL81)")}}else switch(Gb){case "ceDelete":if(!h(Fa))throw Error("CL32");q.pb&&q.pb.d?window.location=q.pb.d.replace("_ce_",Fa):alert("The Delete action is not defined");break;case "ceSave":if(!h(C.fieldId))throw Error("CL33");if(q.pb&&q.pb.s)if(h(C.form))Cc(),C.form.action?C.form.action=q.pb.s:C.form.setAttribute("action",q.pb.s),C.form.submit();
else{a=document.createElement("FORM");document.body.appendChild(a);a.setAttribute("ce","form"+C.container.id);a.action?a.action=q.pb.s:a.setAttribute("action",q.pb.s);a.method?a.method="post":a.setAttribute("method","post");var b=document.createElement("INPUT");b.type="hidden";b.id=C.fieldId;b.name=C.id;vb=!1;b.value=Fb.serialize(cc());a.appendChild(b);a.submit()}else alert("The Save action is not defined");break;default:q.pb&&q.pb.l?window.location=q.pb.l.replace("_ce_",Gb):alert("The Load action is not defined")}},
be=function(a){if(q.help){var b=G(z.fds,a),g=null;h(b)?b.d&&(g=b.d):(b=G(z.acs,a),h(b)&&b.d?g=b.d:(b=G(q.els.rls,a),h(b)&&b.d&&(g=b.d)));h(g)&&0<g.length?Jb(g):Ra()}},lc=function(a){"ceEval"==a||"ceExec"==a?(q.isEval="ceEval"==a,ad()):(ka.close(),w=1,Wc(a))},Zc=function(){if(!(0<p.getChildrenByAttribute(J,"ce235").length)){var a=document.createElement("DIV");a.setAttribute("ce235","true");a.className="ceDelete";var b=document.createElement("SPAN");b.className="ceDeleteButton";b.innerHTML=q.els.lbl.u;
a.appendChild(b);p.getChildrenByAttribute(J,"ce234")[0].appendChild(a);b.onclick=function(g){confirm(q.els.er.e105)&&Wc("ceDelete")}}},Hb=function(a){a=eval(xd(a));return h(a.ce)?a.ce:a},G=function(a,b){if(h(a)){h(a.ce)&&(a=a.ce);for(var g,e=0;e<a.length;e++)if(g=a[e],h(g.v)&&g.v==b||h(g.ID)&&g.ID==b)return g}return null},Ja=function(){var a=[];if(z.references){V("ce802",d.Field,q.els.lbl.h,a);V("ce803",d.Field,q.els.lbl.l,a);for(var b=0;b<z.fds.length;b++){var g=z.fds[b];if(g.t==d.Field&&g.o==m.Collection){if(g.ct==
H.Generic)throw Error("CL83");g.ct!=H.Reference&&a.push(g)}else a.push(g)}}else a=z.fds;var e=h(Fa),k=[],x=h(Ga);for(b=0;b<a.length;b++)if(g=a[b],!h(g.gtb)||g.gtb)if(!g.ir||!e||g.v!=Fa){if(x)if(h(g.grp))if("ce805"==Ga)continue;else{if(g.grp!=Ga)continue}else if("ce805"!=Ga)continue;k.push(g)}return Gd(k,z.references)},Gd=function(a,b){function g(t,A){return t.Name.localeCompare(A.Name)}if(h(Ga))return Ga=null,a;for(var e=[],k=!1,x=0,v;x<a.length;x++)v=a[x],h(v.grp)?he(e,v.grp)||e.push({ID:"ce804",
Name:v.grp}):k=!0;if(0<e.length){v=[];b&&(v.push(a[0]),v.push(a[1]));e.sort(g);for(x=0;x<e.length;x++)v.push(e[x]);k&&v.push({ID:"ce805",Name:q.els.lbl.eg});return v}return a},he=function(a,b){for(var g=0;g<a.length;g++)if(a[g].Name==b)return!0;return!1},Mb=function(){for(var a=[],b=h(Ga),g,e=0;e<z.fds.length;e++)if(g=z.fds[e],!(g.ir||g.t==d.Function||g.o==m.Collection||h(g.st)&&!g.st)){if(b)if(h(g.grp))if("ce805"==Ga)continue;else{if(g.grp!=Ga)continue}else if("ce805"!=Ga)continue;a.push(g)}return Gd(a,
!1)},Nc=function(a){for(var b=[],g=G(z.fds,a),e=0;e<z.fds.length;e++)a=z.fds[e],a.v!=g.v&&a.o==m.Collection&&a.ct==H.Reference&&a.cc==g.cc&&a.cl==g.cl&&a.cv==g.cv&&b.push(a);return b},db=function(){for(var a=[],b=!1,g=0,e;g<z.fds.length;g++)if(e=z.fds[g],e.o!=m.Collection&&e.t!=d.Function&&!e.ir&&(!h(e.st)||e.st)){b=!0;break}b&&V("set",null,q.els.lbl.w,a);for(g=0;g<z.acs.length;g++)a.push(z.acs[g]);return a},sa=function(){if($a(c))return fc();var a=[];var b=0;for(var g=c,e;h(g);){e=D(g);if(e==d.Flow)break;
e==d.LeftSource?b--:e==d.RightSource&&b++;g=h(g.previousSibling)&&D(g.previousSibling)!=d.Flow?g.previousSibling:null}b=0==b;for(e=0;e<q.els.cls.length;e++)g=q.els.cls[e],(!q.isEval&&b||"then"!=g.v)&&a.push(g);return a},Ud=function(a){for(var b=[],g,e=0;e<q.els.cls.length;e++)g=q.els.cls[e],"then"!=g.v&&g.v!=a&&b.push(g);return b},gd=function(a,b){for(var g=0;g<q.els.ops.length;g++)if(q.els.ops[g].v==a&&q.els.ops[g].o==b)return q.els.ops[g];return null},sb=function(a,b){var g=[];if(a.t==d.Function){var e=
a.rt.o;var k=a.rt.l;var x=h(a.rt.mds)}else a.ir?(k=x=!1,e=m.Bool):(k=a.l,e=a.o,x=h(a.mds));for(var v=0;v<q.els.ops.length;v++){var t=q.els.ops[v];if(t.o==e&&(!h(b)||t.v!=b)&&(k||"isNull"!=t.v&&"isNotNull"!=t.v)){if(e==m.Numeric&&x)if(k){if("isNull"!=t.v&&"isNotNull"!=t.v&&"equal"!=t.v&&"notEqual"!=t.v)continue}else if("equal"!=t.v&&"notEqual"!=t.v)continue;g.push(t)}}return g},ud=function(){var a=[];V("true",null,q.els.lbl.t,a);V("false",null,q.els.lbl.f,a);return a},Vc=function(a,b){var g=[];$a(c);
for(var e,k,x,v,t=b.t==d.Function?b.rt.e:b.e,A=b.t==d.Function?b.rt.mds:b.mds,E=0;E<z.fds.length;E++)if(e=z.fds[E],e.o!=m.Collection&&(k=yd(e),v=e.t==d.Function?e.rt.e:e.e,x=e.t==d.Function?e.rt.mds:e.mds,k!=m.Enum||h(t)&&t==v))k!=a||e.ir||(h(x)?h(A)&&x==A&&g.push(e):h(A)||h(b.ftr)&&"any"!=b.ftr&&"any"!=e.ftr&&b.ftr!=e.ftr||g.push(e));return g},ec=function(a){var b=null;if(h(a))g=G(z.fds,a),h(g)&&h(g.ftr)&&(b=g.ftr);else if(g=Ya(c),h(g)){var g=G(z.fds,g.getAttribute("ce208"));h(g)&&h(g.ftr)&&(b=g.ftr)}g=
[];for(var e,k=0,x;k<z.fds.length;k++)e=z.fds[k],x=h(e.ftr)?e.ftr:null,(e.t!=d.Field||e.ir||h(e.mds)||e.o!=m.Numeric||!e.i||h(a)&&e.v==a||null!=b&&"any"!=b&&b!=x&&"any"!=x)&&(e.t!=d.Function||e.rt.o!=m.Numeric||!e.i||h(a)&&e.v==a||null!=b&&"any"!=b&&b!=x&&"any"!=x)||g.push(e);return g},xb=function(a,b){var g=td(a),e=null;null!=g&&(e=g.Client?eval(g.Data[0]+"()"):eval("CodeEffects.Rule."+a));if(h(b)){g=[];for(var k=0,x;k<e.length;k++)x=e[k],h(x.Filter)&&"any"!=b&&"any"!=x.Filter&&x.Filter!=b||g.push(x);
return g}return e},td=function(a){if(!h(q.els.mds))return null;for(var b=0;b<q.els.mds.length;b++)if(q.els.mds[b].Name==a)return q.els.mds[b];return null},yd=function(a){if(a.t==d.Function)return a.rt.o;var b=a.o;if(b==m.Collection){if(a.ct!=H.Value)throw Error("CL71");return a.co}return b},Dd=function(a){if(h(ta)){var b=document.getElementById(ta);h(b)&&(b.className=$rule.trim(b.className.replace("ceCurrent","")))}h(c)&&(c.className=$rule.trim(c.className.replace("ceCurrent","")));a.setAttribute("ce207",
"true");c=a},Oa=function(){if(h(c)){var a=null;c.removeAttribute("ce207");if("INPUT"==c.tagName){var b=Ba(c),g="";if(b==m.Numeric){if(Ba(c)==m.Numeric){var e=parseInt(c.getAttribute("ce212"),10),k=parseInt(c.getAttribute("ce211"),10),x=parseInt(c.value,10);x<k?(a=q.els.er.e109,c.value=k.toString(),c.setAttribute("ce206",c.value)):x>e&&(a=q.els.er.e108,c.value=e.toString(),c.setAttribute("ce206",c.value))}e=c.getAttribute("ce206");k=parseInt(c.getAttribute("ce211"),10);try{if(h(e)){var v=parseFloat(e.replace(",",
"."));g=h(v)&&"-0."!=e&&"0."!=e?v.toString():k.toString()}else g=k.toString()}catch(t){g=k.toString()}}else g=$rule.encode(c.value);v=c;h(ub)?(b=document.getElementById(ub),h(b)&&(c=I(b),c.innerHTML=0==g.length?q.els.lbl.em:g,c.setAttribute("ce206",g),c.setAttribute("ce205",u.Input),c.style.display="",h(a)?(c.className="ceValidationWarning",c.title=a):(c.className="ceValue ceCurrent",c.title=""))):(ba({t:D(v),id:null,v:g,n:0==g.length?q.els.lbl.em:g,st:b,ct:qa(v),ft:U(v),it:u.Input,h:!1,fv:!1}),h(a)&&
(c.className="ceValidationWarning",c.title=a));ub=null;C.container.removeChild(v)}}},fc=function(){var a=[];a.push(G(q.els.cls,"and"));for(var b=bb(),g=!1,e=!1,k=0;k<b.length;k++){if(D(b[k])==d.Flow&&"else"==b[k].getAttribute("ce208")){g=!0;break}b[k].id==c.id&&(e=!0)}if(!e&&g)return a;for(b=0;b<q.els.fls.length;b++)"if"==q.els.fls[b].v||g&&"else"==q.els.fls[b].v||a.push(q.els.fls[b]);return a},Ib=function(a,b){for(var g,e=0;e<a.length;e++)if(g=a[e],g.v==b)return g.n;return null},Dc=function(a){return Ib(q.els.dsc,
"ce803"==a?"doesNotExist":"exists")},Va=function(){function a(k){var x=0,v=0,t;a:{for(t=c;h(t);){if(D(t)==d.RightBracket)break a;t=t.nextSibling}t=null}for(t=t.previousSibling;h(t)&&D(t)!=d.LeftBracket;)qa(t)==r.LeftParenthesis&&x++,qa(t)==r.RightParenthesis&&v++,t=t.previousSibling;x>v&&V(r.RightParenthesis,null,q.els.lbl.pe,k);V(r.Addition,null,"&#43;",k);V(r.Subtraction,null,"&#150;",k);V(r.Multiplication,null,"&#215;",k);V(r.Division,null,"&#247;",k)}var b=[];switch(D(xa(c))){case d.LeftBracket:V(r.LeftParenthesis,
null,q.els.lbl.pb,b);V(r.Number,null,qb(m.Numeric),b);for(var g=ec(),e=0;e<g.length;e++)V(g[e].t==d.Function?r.Function:r.Field,g[e].v,g[e].n,b);break;case d.Value:case d.Calculation:g=qa(c);g==r.None&&(g=qa(xa(c)));switch(g){case r.Number:case r.Field:case r.RightParenthesis:a(b);break;case r.Function:U(c)==n.End&&a(b);break;case r.LeftParenthesis:case r.Addition:case r.Subtraction:case r.Multiplication:case r.Division:for(V(r.LeftParenthesis,null,q.els.lbl.pb,b),V(r.Number,null,qb(m.Numeric),b),
g=ec(),e=0;e<g.length;e++)V(g[e].t==d.Function?r.Function:r.Field,g[e].v,g[e].n,b)}break;default:throw Error("CL80");}return b},Tc=function(a,b){if(!h(a)||0==a.ps.length)return b;var g=lb(c);for(0>g&&(g=0);g<a.ps.length;){if(h(a.ps[g].f))return a.ps[g].f;g++}return b},V=function(a,b,g,e){var k=new p.Menu.Item;k.ID=a;h(b)&&(k.Type=b+"");k.Name=g;e.push(k)},fe=function(a,b){if(a==r.None||b==r.None)throw Error("CL90");switch(a){case r.Field:return b==r.Number||b==r.Field;case r.Number:return b==r.Field||
b==r.Number;case r.LeftParenthesis:return b==r.LeftParenthesis;case r.RightParenthesis:return b==r.RightParenthesis;default:return b==r.Multiplication||b==r.Division||b==r.Addition||b==r.Subtraction}},pd=function(a,b){var g=[];if(!h(a)||0==a.length)return g;b=b.toLowerCase();for(var e,k=0;k<a.length;k++)e=a[k].n||a[k].Name,e.length>=b.length&&e.substr(0,b.length).toLowerCase()==b&&g.push(a[k]);return g},ie=function(){if(!h(c))return"i101";if(8==w)return"i126";var a=xa(c);switch(D(a)){case d.Flow:return"else"==
a.getAttribute("ce208")?"i110":"i103";case d.LeftSource:case d.LeftParenthesis:return"i103";case d.RightSource:case d.RightParenthesis:return"i111";case d.Field:if(Da)return"i127";a=G(z.fds,a.getAttribute("ce208"));return h(a)?a.o==m.Collection&&a.ct==H.Reference?"i124":"i104":"i124";case d.Exists:return Da?"i136":"i135";case d.Where:return"i124";case d.LeftBracket:return"i106";case d.RightBracket:return"i121";case d.Calculation:return"i108";case d.Action:switch(U(a)){case n.End:return Pa(a)&&Da?
"i128":"else"==Mc(a,d.Flow).getAttribute("ce208")?"i124":"i125";case n.Name:return Da?"i128":"i123";default:return"i123"}case d.Function:switch(U(a)){case n.End:return Pa(a)&&Da?"i127":"i104";case n.Name:return Da?"i127":"i123";default:return"i123"}case d.Operator:if(Da)return"i129";var b=Ba(a);return b==m.Numeric?(a=Ya(a),a=h(a)?G(z.fds,a.getAttribute("ce208")):null,h(a)&&a.cal?"i122":"i113"):b==m.String?"i113":b==m.Date?"i114":b==m.Time?"i117":"i119";case d.Value:return b=Ba(a),b==m.String||b==
m.Numeric?h(a.getAttribute("ce207"))?"i105":"i107":b==m.Date?3==w?"i109":Da?"i132":"i115":b==m.Time?4==w?"i116":Da?"i133":"i118":Da?"i134":"i120";case d.Clause:return"then"==a.getAttribute("ce208")?"i110":Da?"i129":"i103";default:return"i122"}},qb=function(a,b){switch(a){case m.String:return q.els.lbl.s;case m.Date:return q.els.lbl.v;case m.Time:return q.els.lbl.j;case m.Numeric:return b?q.els.lbl.e:q.els.lbl.m;case m.Bool:return q.els.lbl.b;case m.Enum:return q.els.lbl.e;default:throw Error("CL45");
}},$a=function(a){var b=h(a.getAttribute("ce202"))?D(a):null;return b==d.Setter||b==d.Action?!0:b==d.Flow?!1:h(a.previousSibling)?$a(a.previousSibling):!1},hd=function(a,b,g){if(!h(a)||!h(a.ps))return null;for(var e=g;e<=a.ps.length;e++)if(a.ps[e].o==b)return a.ps[e];return 0<g?hd(a,b,0):null},Sb=function(a,b){var g=D(a),e=U(a);return a.getAttribute&&h(a.getAttribute("ce204"))&&(g==d.Function||g==d.Action||g==d.Calculation&&(e==n.Name||e==n.End))&&e==b?a:h(a.previousSibling)?Sb(a.previousSibling,
b):null},Gc=function(a,b){var g=D(a),e=U(a);return a.getAttribute&&h(a.getAttribute("ce204"))&&(g==d.Function||g==d.Action||g==d.Calculation&&(e==n.Name||e==n.End))&&e==b?a:h(a.nextSibling)?Gc(a.nextSibling,b):null},Mc=function(a,b){return h(a)?a.getAttribute&&h(a.getAttribute("ce202"))&&D(a)==b?a:h(a.previousSibling)?Mc(a.previousSibling,b):null:null},Ya=function(a){return h(a)?h(a.getAttribute)&&h(a.getAttribute("ce202"))&&(D(a)==d.Field||(D(a)==d.Function||D(a)==d.Action)&&U(a)==n.Name||D(a)==
d.Calculation&&U(a)==n.Name)?a:h(a.previousSibling)?Ya(a.previousSibling):null:null},Hd=function(a){if(!h(a))return null;if(h(a.getAttribute)&&h(a.getAttribute("ce202"))){var b=D(a);if(b==d.RightSource||b==d.LeftSource)return a;if(h(a.previousSibling))return Hd(a.previousSibling)}return null},mb=function(a,b){return h(a)?h(a.getAttribute)&&h(a.getAttribute("ce202"))&&D(a)==b?a:h(a.nextSibling)?mb(a.nextSibling,b):null:null},ic=function(a){return a.getAttribute&&h(a.getAttribute("ce202"))&&D(a)!=d.HtmlTag?
a:h(a.nextSibling)?ic(a.nextSibling):null},xa=function(a){return Vb(a)?a:h(a.previousSibling)?xa(a.previousSibling):null},Wa=function(a){return Vb(a)?a:h(a.nextSibling)?Wa(a.nextSibling):null},Ob=function(a,b){if(!h(a))return null;var g=U(a);return g==n.End?null:g==n.Param&&Ba(a,!0)==b?a:h(a.nextSibling)?Ob(a.nextSibling,b):null},$c=function(){aa=[];if(h(q.els.lbl.y)){var a=new p.Menu.Item;a.ID="ceEval";a.Name=q.els.lbl.y;aa.push(a)}h(q.els.lbl.x)&&(a=new p.Menu.Item,a.ID="ceExec",a.Name=q.els.lbl.x,
aa.push(a));if(h(q.els.rls))for(var b=0;b<q.els.rls.length;b++)a=new p.Menu.Item,a.ID=q.els.rls[b].v||q.els.rls[b].ID,a.Name=q.els.rls[b].n||q.els.rls[b].Name,aa.push(a)},hb=function(a,b){if(!b){var g=Sb(a,n.Name);ta=g.id;c=I(g)}c=c.nextSibling},Z=function(a){z=null;var b=q.els.src[0].n;h(a)&&(a=Hd(a),h(a)&&(b=a.getAttribute("ce208")));for(a=0;a<q.els.src.length;a++)if(q.els.src[a].n==b){z=q.els.src[a];h(z.fds)&&z.fds.length||(z.fds=[]);h(z.acs)&&z.acs.length||(z.acs=[]);if(!h(z.references))for(z.references=
!1,a=0;a<z.fds.length;a++)if(b=z.fds[a],b.t==d.Field&&b.o==m.Collection&&b.ct==H.Reference){z.references=!0;break}break}if(!h(z))throw Error("CL91");},I=function(a){if(h(a)){if(h(ta)){var b=document.getElementById(ta);h(b)&&(b.className=$rule.trim(b.className.replace("ceCurrent","")))}h(c)&&(c.className=$rule.trim(c.className.replace("ceCurrent","").replace("ceHighlight","")));"INPUT"!=a.tagName&&0>a.className.indexOf("ceCurrent")&&(a.className+=" ceCurrent");return a}},Pa=function(a){var b=D(a),
g=U(a);return b==d.Function||b==d.Action||b==d.Calculation&&(g==n.Name||g==n.End)?(a=Aa(a),h(a)&&h(a.ps)?0==a.ps.length:!0):!1},Vb=function(a){return a.getAttribute&&h(a.getAttribute("ce202"))?(a=D(a),a!=d.Tab&&a!=d.NewLine&&a!=d.HtmlTag):!1},yb=function(a,b,g,e){return a==d.Value&&(b==m.String||b==m.Numeric)||a==d.Calculation&&g==r.Number||(a==d.Function||a==d.Action)&&e==u.Input&&(b==m.String||b==m.Numeric)},La=function(a){return 31<a&&40>a||41<a&&60>a||61==a||63<a&&91>a||96<a&&123>a||222<a},ld=
function(){for(var a=bb(),b=0;b<a.length;b++)switch(D(a[b])){case d.Clause:case d.Function:case d.Field:case d.Operator:case d.Value:case d.Action:case d.LeftParenthesis:case d.RightParenthesis:case d.Calculation:return!0}return!1},va=function(){Bc();Da||Ra();3==w?Ca.position():4==w?ja.position():(6==w||8==w)&&Ta()},ra=function(){if(h(c.nextSibling)){if(q.right){var a=D(c.nextSibling);return a!=d.NewLine&&a!=d.Tab}return!1}return!0},mc=function(){if(h(c.nextSibling))for(c=c.nextSibling;h(c.nextSibling)&&
!Vb(c.nextSibling);){var a=c.nextSibling;C.container.removeChild(c);c=a}pb()},bd=function(a){tc&&8<p.Client.version&&window.Modernizr&&3>sc?sc++:(Na=0,1!=w&&2!=w&&va())},ae=function(){if(ma){6!=w&&8!=w||Ta();var a=D(c);a!=d.NewLine&&a!=d.Tab?wb(!1):va()}},Ta=function(){rc=0;y="";P=[];ka.close();w=0},dc=function(a){a=$rule.getChildrenByAttribute(document.body,"class",a);if(h(a)&&0<a.length)for(var b=0,g,e=a.length;b<e;b++)g=a[b],h(g.parentNode)&&g.parentNode.removeChild(g)},ed=function(){C.container.innerHTML=
"";var a=document.createElement("SPAN");a.className="ceEmpty";a.style.paddingBottom="2px";a.style.display="inline-block";a.style.whiteSpace="nowrap";a.style.cursor="default";a.innerHTML=q.els.lbl.g;C.container.appendChild(a);c=null},fd=function(){h(C.container)&&(C.container.innerHTML="",C.container.style.color="")},jc=function(a){if(p.getScrollHeight()>a)try{window.scroll(p.getScrollWidth(),a)}catch(b){}},Lc=function(a,b){var g=p.getWindowDimensions().height,e=p.getScrollHeight();if(g+e<a+b)try{window.scroll(p.getScrollWidth(),
e+(a+b-(g+e)))}catch(k){}},Pb=function(a){return String(a).replace(/\\/g,"\\\\").replace(/'/g,"'").replace(/"/g,"&quot;")},Yb=function(a){return String(a).replace(/&#92;/g,"\\").replace(/&#39;/g,"'").replace(/&quot;/g,'"')},xd=function(a){return h(a)?a.replace("+","$"):a},Ba=function(a,b){var g=parseInt(a.getAttribute("ce209"),10);return g!=m.Collection||b?g:G(z.fds,Ya(c).getAttribute("ce208")).co},za=function(a,b){if(h(b)&&0<b.length){var g=p.defined(b)?b:"";a.className=g}},Zb=function(a){return"true"==
a?q.els.lbl.t:q.els.lbl.f},Ra=function(a,b){if(q.help)if(M.className="ceHelp",h(b)){var g=q.els.ms[a].replace("{0}",b);Jb(g)}else Jb(q.els.ms[h(a)?a:ie()])},ab=function(a){return h(a)&&a.getAttribute&&"if"==a.getAttribute("ce208")},bb=function(){return p.getChildrenByTagName(C.container,"SPAN",!1)},kc=function(a){if(h(c)){var b=c,g=!1;do{"true"==b.getAttribute("ce218")?(b.className=$rule.trim(b.className.replace("ceSelected","")),b.setAttribute("ce218","false")):(b.className=p.trim(b.className)+" ceSelected",
b.setAttribute("ce218","true"),g=!0);if(b.id==ia)break;b=a?b.previousSibling:b.nextSibling}while(h(b)&&b.id!=ia);h(b)&&(b.className=$rule.trim(b.className.replace("ceSelected","")),b.setAttribute("ce218","false"),g&&(b.className=p.trim(b.className)+" ceSelected",b.setAttribute("ce218","true")))}},D=function(a){return parseInt(a.getAttribute("ce202"),10)},qa=function(a){return parseInt(a.getAttribute("ce203"),10)},U=function(a){return parseInt(a.getAttribute("ce204"),10)},Ua=function(a){return parseInt(a.getAttribute("ce205"),
10)},Ab=function(){Ca.hide()},zb=function(){ja.hide()},Od=function(a){return id(a)},Qd=function(a){return Fc(a)},Pd=function(a){return Ec(a)},Jd=function(a){Wd(a)},Jb=function(a){h(M)&&h(a)&&(M.innerHTML=a)},Rb=function(a){q.help&&(h(a)||(a="--------------"),M.innerHTML=a,h(M)&&(M.className+=" ceValueWarn"))}};
